<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Protocol.Streamlet.Invariants.VotedOnlyOnce</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="Agda.css" />
</head>
<body>
<!--
<pre class="Agda"><a id="14" class="Symbol">{-#</a> <a id="18" class="Keyword">OPTIONS</a> <a id="26" class="Pragma">--safe</a> <a id="33" class="Symbol">#-}</a>
<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Prelude.html" class="Module">Prelude</a>
<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Hash.html" class="Module">Hash</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Protocol.Streamlet.Assumptions.html" class="Module">Protocol.Streamlet.Assumptions</a>

<a id="119" class="Keyword">module</a> <a id="126" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html" class="Module">Protocol.Streamlet.Invariants.VotedOnlyOnce</a> <a id="170" class="Symbol">(</a><a id="171" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#171" class="Bound">⋯</a> <a id="173" class="Symbol">:</a> <a id="175" class="Symbol">_)</a> <a id="178" class="Symbol">(</a><a id="179" class="Keyword">open</a> <a id="184" href="Protocol.Streamlet.Assumptions.html#222" class="Module">Assumptions</a> <a id="196" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#171" class="Bound">⋯</a><a id="197" class="Symbol">)</a> <a id="199" class="Keyword">where</a>

<a id="206" class="Keyword">open</a> <a id="211" class="Keyword">import</a> <a id="218" href="Protocol.Streamlet.html" class="Module">Protocol.Streamlet</a> <a id="237" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#171" class="Bound">⋯</a>

<a id="240" class="Keyword">open</a> <a id="245" class="Keyword">import</a> <a id="252" href="Protocol.Streamlet.Invariants.Unforgeability.html" class="Module">Protocol.Streamlet.Invariants.Unforgeability</a> <a id="297" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#171" class="Bound">⋯</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Protocol.Streamlet.Invariants.Votes.html" class="Module">Protocol.Streamlet.Invariants.Votes</a> <a id="347" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#171" class="Bound">⋯</a>
</pre>-->
<pre class="Agda"><a id="VotedOnlyOncePerEpoch¹"></a><a id="366" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#366" class="Function">VotedOnlyOncePerEpoch¹</a> <a id="389" class="Symbol">:</a> <a id="391" href="Protocol.Streamlet.Global.Traces.html#966" class="Function">StateProperty</a>
<a id="405" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#366" class="Function">VotedOnlyOncePerEpoch¹</a> <a id="428" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#428" class="Bound">s</a> <a id="430" class="Symbol">=</a> <a id="432" class="Symbol">∀</a> <a id="434" class="Symbol">{</a><a id="435" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#435" class="Bound">p</a><a id="436" class="Symbol">}</a> <a id="438" class="Symbol">⦃</a> <a id="440" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#440" class="Bound">_</a> <a id="442" class="Symbol">:</a> <a id="444" href="Protocol.Streamlet.Assumptions.html#1062" class="Field">Honest</a> <a id="451" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#435" class="Bound">p</a> <a id="453" class="Symbol">⦄</a> <a id="455" class="Symbol">→</a> <a id="457" class="Keyword">let</a> <a id="461" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#461" class="Bound">ms</a> <a id="464" class="Symbol">=</a> <a id="466" class="Symbol">(</a><a id="467" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#428" class="Bound">s</a> <a id="469" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="471" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#435" class="Bound">p</a><a id="472" class="Symbol">)</a> <a id="474" class="Symbol">.</a><a id="475" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a> <a id="478" class="Keyword">in</a>
  <a id="483" class="Symbol">∀</a> <a id="485" class="Symbol">{</a><a id="486" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#486" class="Bound">b</a> <a id="488" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#488" class="Bound">b′</a><a id="490" class="Symbol">}</a> <a id="492" class="Symbol">→</a>
  <a id="496" href="Prelude.InferenceRules.html#56097" class="Function Operator">∙</a> <a id="498" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#435" class="Bound">p</a> <a id="500" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="502" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="510" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#461" class="Bound">ms</a> <a id="513" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#486" class="Bound">b</a>
  <a id="517" href="Prelude.InferenceRules.html#56028" class="Function Operator">∙</a> <a id="519" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#435" class="Bound">p</a> <a id="521" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="523" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="531" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#461" class="Bound">ms</a> <a id="534" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#488" class="Bound">b′</a>
  <a id="539" href="Prelude.InferenceRules.html#56028" class="Function Operator">∙</a> <a id="541" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#486" class="Bound">b</a> <a id="543" class="Symbol">.</a><a id="544" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a> <a id="550" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="552" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#488" class="Bound">b′</a> <a id="555" class="Symbol">.</a><a id="556" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a>
    <a id="566" href="Prelude.InferenceRules.html#14094" class="Function Operator">────────────────────</a>
    <a id="591" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#486" class="Bound">b</a> <a id="593" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="595" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#488" class="Bound">b′</a>

<a id="votedOnlyOncePerEpoch¹"></a><a id="599" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#599" class="Function">votedOnlyOncePerEpoch¹</a> <a id="622" class="Symbol">:</a> <a id="624" href="Prelude.Closures.html#3717" class="Function">Invariant</a> <a id="634" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#366" class="Function">VotedOnlyOncePerEpoch¹</a>
<a id="657" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#599" class="Function">votedOnlyOncePerEpoch¹</a> <a id="680" class="Symbol">(_</a> <a id="683" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="685" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="690" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="692" class="Symbol">(_</a> <a id="695" href="Prelude.Closures.html#689" class="InductiveConstructor Operator">∎</a><a id="696" class="Symbol">))</a> <a id="699" class="Symbol">{</a><a id="700" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#700" class="Bound">p</a><a id="701" class="Symbol">}</a> <a id="703" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#703" class="Bound">p∈</a> <a id="706" class="Symbol">_</a> <a id="708" class="Symbol">_</a>
  <a id="712" class="Keyword">rewrite</a> <a id="720" class="Keyword">let</a> <a id="724" class="Keyword">open</a> <a id="729" href="Protocol.Streamlet.Global.Step.html#3796" class="Module">∣Base∣</a> <a id="736" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#700" class="Bound">p</a> <a id="738" class="Keyword">in</a> <a id="741" href="Protocol.Streamlet.Global.Step.html#3830" class="Function">lookup✓</a>
  <a id="751" class="Symbol">=</a> <a id="753" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="758" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#703" class="Bound">p∈</a> <a id="761" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="764" class="Symbol">λ</a> <a id="766" class="Symbol">()</a>
<a id="769" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#599" class="Function">votedOnlyOncePerEpoch¹</a> <a id="792" class="Symbol">{</a><a id="793" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#793" class="Bound">s′</a><a id="795" class="Symbol">}</a> <a id="797" class="Symbol">(_</a> <a id="800" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="802" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="807" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="809" class="Symbol">(_</a> <a id="812" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">⟨</a> <a id="814" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#814" class="Bound">s→</a> <a id="817" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">∣</a> <a id="819" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#819" class="Bound">s</a> <a id="821" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">⟩←—</a> <a id="825" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#825" class="Bound">tr</a><a id="827" class="Symbol">))</a>
  <a id="832" class="Symbol">{</a><a id="833" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#833" class="Bound">p</a><a id="834" class="Symbol">}</a> <a id="836" class="Symbol">⦃</a> <a id="838" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#838" class="Bound">hp</a> <a id="841" class="Symbol">⦄</a> <a id="843" class="Symbol">{</a><a id="844" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#844" class="Bound">b</a><a id="845" class="Symbol">}</a> <a id="847" class="Symbol">{</a><a id="848" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#848" class="Bound">b′</a><a id="850" class="Symbol">}</a> <a id="852" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#852" class="Bound">p∈</a> <a id="855" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#855" class="Bound">p∈′</a> <a id="859" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="866" class="Keyword">with</a> <a id="871" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#871" class="Bound">Rs</a> ← <a id="876" href="Data.Product.Base.html#1932" class="Function Operator">-,</a> <a id="879" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="884" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="886" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#825" class="Bound">tr</a>
  <a id="891" class="Keyword">with</a> <a id="896" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> ← <a id="901" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#599" class="Function">votedOnlyOncePerEpoch¹</a> <a id="924" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#871" class="Bound">Rs</a> <a id="927" class="Symbol">{</a><a id="928" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#833" class="Bound">p</a><a id="929" class="Symbol">}{</a><a id="931" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#844" class="Bound">b</a><a id="932" class="Symbol">}{</a><a id="934" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#848" class="Bound">b′</a><a id="936" class="Symbol">}</a>
  <a id="940" class="Keyword">with</a> <a id="945" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#814" class="Bound">s→</a>
<a id="948" class="Symbol">...</a> <a id="952" class="Symbol">|</a> <a id="954" href="Protocol.Streamlet.Global.Step.html#2366" class="InductiveConstructor">Deliver</a> <a id="962" class="Symbol">{</a><a id="963" class="Argument">env</a> <a id="967" class="Symbol">=</a> <a id="969" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">[</a> <a id="971" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#971" class="Bound">p′</a> <a id="974" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">∣</a> <a id="976" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#976" class="Bound">m′</a> <a id="979" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">⟩</a><a id="980" class="Symbol">}</a> <a id="982" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#982" class="Bound">env∈</a>
  <a id="989" class="Symbol">=</a> <a id="991" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="999" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="1002" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1048" class="Function">≪p∈</a> <a id="1006" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1013" class="Keyword">where</a>
  <a id="1021" class="Keyword">open</a> <a id="1026" href="Protocol.Streamlet.Global.Step.html#3985" class="Module">∣Deliver∣</a> <a id="1036" class="Bound">p</a> <a id="1038" class="Bound">s</a> <a id="1040" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#982" class="Bound">env∈</a>

  <a id="1048" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1048" class="Function">≪p∈</a> <a id="1052" class="Symbol">:</a> <a id="1054" class="Bound">p</a> <a id="1056" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="1058" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="1066" class="Symbol">((</a><a id="1068" class="Bound">s</a> <a id="1070" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="1072" class="Bound">p</a><a id="1073" class="Symbol">)</a> <a id="1075" class="Symbol">.</a><a id="1076" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a><a id="1078" class="Symbol">)</a> <a id="1080" class="Bound">b</a>
      <a id="1088" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1090" class="Bound">p</a> <a id="1092" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="1094" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="1102" class="Symbol">((</a><a id="1104" class="Bound">s</a> <a id="1106" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="1108" class="Bound">p</a><a id="1109" class="Symbol">)</a> <a id="1111" class="Symbol">.</a><a id="1112" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a><a id="1114" class="Symbol">)</a> <a id="1116" class="Bound">b′</a>
  <a id="1121" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1048" class="Function">≪p∈</a> <a id="1125" class="Keyword">rewrite</a> <a id="1133" href="Protocol.Streamlet.Global.Step.html#4348" class="Function">db≡</a> <a id="1137" class="Symbol">=</a> <a id="1139" class="Bound">p∈</a> <a id="1142" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1144" class="Bound">p∈′</a>
<a id="1148" class="Symbol">...</a> <a id="1152" class="Symbol">|</a> <a id="1154" href="Protocol.Streamlet.Global.Step.html#2518" class="InductiveConstructor">AdvanceEpoch</a>
  <a id="1169" class="Keyword">rewrite</a> <a id="1177" class="Keyword">let</a> <a id="1181" class="Keyword">open</a> <a id="1186" href="Protocol.Streamlet.Global.Step.html#3883" class="Module">∣AdvanceEpoch∣</a> <a id="1201" class="Bound">p</a> <a id="1203" class="Bound">s</a> <a id="1205" class="Keyword">in</a> <a id="1208" href="Protocol.Streamlet.Global.Step.html#3927" class="Function">lookup✓</a>
  <a id="1218" class="Symbol">=</a> <a id="1220" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="1223" class="Bound">p∈</a> <a id="1226" class="Bound">p∈′</a> <a id="1230" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="1235" class="Symbol">...</a> <a id="1239" class="Symbol">|</a> <a id="1241" href="Protocol.Streamlet.Global.Step.html#2625" class="InductiveConstructor">Drop</a> <a id="1246" class="Symbol">_</a>
  <a id="1250" class="Symbol">=</a> <a id="1252" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="1255" class="Bound">p∈</a> <a id="1258" class="Bound">p∈′</a> <a id="1262" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="1267" class="Symbol">...</a> <a id="1271" class="Symbol">|</a> <a id="1273" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="1283" class="Symbol">{</a><a id="1284" class="Argument">p</a> <a id="1286" class="Symbol">=</a> <a id="1288" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1288" class="Bound">p′</a><a id="1290" class="Symbol">}{</a><a id="1292" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1292" class="Bound">mm</a><a id="1294" class="Symbol">}{</a><a id="1296" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1296" class="Bound">ls′</a><a id="1299" class="Symbol">}</a> <a id="1301" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1301" class="Bound">ls→</a>
  <a id="1307" class="Symbol">=</a> <a id="1309" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a>
  <a id="1315" class="Keyword">where</a>
  <a id="1323" class="Keyword">open</a> <a id="1328" href="Protocol.Streamlet.Global.Step.html#4791" class="Module">∣LocalStep∣</a> <a id="1340" class="Bound">p</a> <a id="1342" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1288" class="Bound">p′</a> <a id="1345" class="Bound">s</a> <a id="1347" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1292" class="Bound">mm</a> <a id="1350" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1296" class="Bound">ls′</a>

  <a id="1357" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1357" class="Function">nfo</a> <a id="1361" class="Symbol">=</a> <a id="1363" href="Protocol.Streamlet.Invariants.Votes.html#6462" class="Function">noFutureOwnVotes</a> <a id="1380" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#871" class="Bound">Rs</a>

  <a id="1386" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a> <a id="1390" class="Symbol">:</a> <a id="1392" class="Bound">b</a> <a id="1394" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1396" class="Bound">b′</a>
  <a id="1401" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a> <a id="1405" class="Keyword">with</a> <a id="1410" class="Bound">p</a> <a id="1412" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1414" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1288" class="Bound">p′</a>
  <a id="1419" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a> <a id="1423" class="Symbol">|</a> <a id="1425" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="1428" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1428" class="Bound">p≢</a> <a id="1431" class="Symbol">=</a> <a id="1433" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="1436" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1464" class="Function">p∈✖</a> <a id="1440" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1609" class="Function">p∈′✖</a> <a id="1445" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1454" class="Keyword">where</a>
    <a id="1464" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1464" class="Function">p∈✖</a> <a id="1468" class="Symbol">:</a> <a id="1470" class="Bound">p</a> <a id="1472" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="1474" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="1482" class="Symbol">((</a><a id="1484" class="Bound">s</a> <a id="1486" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="1488" class="Bound">p</a><a id="1489" class="Symbol">)</a> <a id="1491" class="Symbol">.</a><a id="1492" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a><a id="1494" class="Symbol">)</a> <a id="1496" class="Bound">b</a>
    <a id="1502" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1464" class="Function">p∈✖</a> <a id="1506" class="Keyword">with</a> <a id="1511" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1513" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1292" class="Bound">mm</a>
    <a id="1520" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1464" class="Function">...</a> <a id="1524" class="Symbol">|</a> <a id="1526" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1528" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1533" class="Symbol">_</a>  <a id="1536" class="Keyword">rewrite</a> <a id="1544" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="1552" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1428" class="Bound">p≢</a> <a id="1555" class="Symbol">=</a> <a id="1557" class="Bound">p∈</a>
    <a id="1564" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1464" class="Function">...</a> <a id="1568" class="Symbol">|</a> <a id="1570" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1572" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1580" class="Keyword">rewrite</a> <a id="1588" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="1596" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1428" class="Bound">p≢</a> <a id="1599" class="Symbol">=</a> <a id="1601" class="Bound">p∈</a>

    <a id="1609" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1609" class="Function">p∈′✖</a> <a id="1614" class="Symbol">:</a> <a id="1616" class="Bound">p</a> <a id="1618" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="1620" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="1628" class="Symbol">((</a><a id="1630" class="Bound">s</a> <a id="1632" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="1634" class="Bound">p</a><a id="1635" class="Symbol">)</a> <a id="1637" class="Symbol">.</a><a id="1638" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a><a id="1640" class="Symbol">)</a> <a id="1642" class="Bound">b′</a>
    <a id="1649" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1609" class="Function">p∈′✖</a> <a id="1654" class="Keyword">with</a> <a id="1659" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1661" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1292" class="Bound">mm</a>
    <a id="1668" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1609" class="Function">...</a> <a id="1672" class="Symbol">|</a> <a id="1674" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1676" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1681" class="Symbol">_</a>  <a id="1684" class="Keyword">rewrite</a> <a id="1692" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="1700" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1428" class="Bound">p≢</a> <a id="1703" class="Symbol">=</a> <a id="1705" class="Bound">p∈′</a>
    <a id="1713" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1609" class="Function">...</a> <a id="1717" class="Symbol">|</a> <a id="1719" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1721" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1729" class="Keyword">rewrite</a> <a id="1737" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="1745" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1428" class="Bound">p≢</a> <a id="1748" class="Symbol">=</a> <a id="1750" class="Bound">p∈′</a>
  <a id="1756" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a> <a id="1760" class="Symbol">|</a> <a id="1762" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1766" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1775" class="Keyword">rewrite</a> <a id="1783" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>
    <a id="1795" class="Keyword">with</a> <a id="1800" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1802" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1301" class="Bound">ls→</a>
  <a id="1808" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a> <a id="1812" class="Symbol">|</a> <a id="1814" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1818" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1823" class="Symbol">|</a> <a id="1825" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1827" href="Protocol.Streamlet.Local.Step.html#1314" class="InductiveConstructor">ProposeBlock</a> <a id="1840" class="Symbol">{</a><a id="1841" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1841" class="Bound">ch</a><a id="1843" class="Symbol">}</a> <a id="1845" class="Symbol">{</a><a id="1846" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1846" class="Bound">txs</a><a id="1849" class="Symbol">}</a> <a id="1851" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1851" class="Bound">ready</a> <a id="1857" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1857" class="Bound">pLeader</a> <a id="1865" class="Symbol">_</a> <a id="1867" class="Symbol">_</a>
    <a id="1873" class="Keyword">rewrite</a> <a id="1881" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>
    <a id="1893" class="Keyword">with</a> <a id="1898" class="Bound">s</a> <a id="1900" class="Symbol">.</a><a id="1901" href="Protocol.Streamlet.Global.State.html#728" class="Field">e-now</a> <a id="1907" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1909" class="Bound">b</a> <a id="1911" class="Symbol">.</a><a id="1912" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a>
  <a id="1920" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">...</a> <a id="1924" class="Symbol">|</a> <a id="1926" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="1929" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1929" class="Bound">b≢</a>
    <a id="1936" class="Symbol">=</a> <a id="1938" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="1941" class="Symbol">(</a><a id="1942" href="Protocol.Streamlet.Local.State.html#6251" class="Function">voteIds-∷˘′</a> <a id="1954" class="Symbol">{</a><a id="1955" class="Argument">b</a> <a id="1957" class="Symbol">=</a> <a id="1959" class="Bound">b</a><a id="1960" class="Symbol">}</a>  <a id="1963" class="Symbol">(</a><a id="1964" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1929" class="Bound">b≢</a> <a id="1967" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1969" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="1974" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a><a id="1979" class="Symbol">)</a> <a id="1981" class="Bound">p∈</a><a id="1983" class="Symbol">)</a>
         <a id="1994" class="Symbol">(</a><a id="1995" href="Protocol.Streamlet.Local.State.html#6251" class="Function">voteIds-∷˘′</a> <a id="2007" class="Symbol">{</a><a id="2008" class="Argument">b</a> <a id="2010" class="Symbol">=</a> <a id="2012" class="Bound">b′</a><a id="2014" class="Symbol">}</a> <a id="2016" class="Symbol">(</a><a id="2017" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1929" class="Bound">b≢</a> <a id="2020" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2022" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="2027" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a><a id="2032" class="Symbol">)</a> <a id="2034" class="Bound">p∈′</a><a id="2037" class="Symbol">)</a>
         <a id="2048" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="2055" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">...</a> <a id="2059" class="Symbol">|</a> <a id="2061" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="2065" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2070" class="Symbol">=</a>
    <a id="2076" class="Keyword">let</a> <a id="2080" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2080" class="Bound">≡b</a>  <a id="2084" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2086" class="Symbol">_</a> <a id="2088" class="Symbol">=</a> <a id="2090" href="Protocol.Streamlet.Local.State.html#6379" class="Function">voteIds-head</a> <a id="2103" class="Bound">b</a>  <a id="2106" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2686" class="Function">p∉</a>  <a id="2110" class="Bound">p∈</a>
        <a id="2121" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2121" class="Bound">≡b′</a> <a id="2125" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2127" class="Symbol">_</a> <a id="2129" class="Symbol">=</a> <a id="2131" href="Protocol.Streamlet.Local.State.html#6379" class="Function">voteIds-head</a> <a id="2144" class="Bound">b′</a> <a id="2147" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2806" class="Function">p∉′</a> <a id="2151" class="Bound">p∈′</a>
    <a id="2159" class="Keyword">in</a> <a id="2162" href="Relation.Binary.PropositionalEquality.Core.html#1757" class="Function">trans</a> <a id="2168" class="Symbol">(</a><a id="2169" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="2173" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2080" class="Bound">≡b</a><a id="2175" class="Symbol">)</a> <a id="2177" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2121" class="Bound">≡b′</a>
    <a id="2185" class="Keyword">where</a>
    <a id="2195" class="Keyword">open</a> <a id="2200" href="Protocol.Streamlet.Global.Step.html#3153" class="Module">∣ProposeBlock∣</a> <a id="2215" class="Bound">p</a> <a id="2217" class="Symbol">⦃</a> <a id="2219" class="Bound">hp</a> <a id="2222" class="Symbol">⦄</a> <a id="2224" class="Bound">s</a> <a id="2226" class="Bound">ch</a> <a id="2229" class="Bound">txs</a>

    <a id="2238" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2238" class="Function">m∉</a> <a id="2241" class="Symbol">:</a> <a id="2243" class="Symbol">∀</a> <a id="2245" class="Symbol">{</a><a id="2246" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2246" class="Bound">m</a><a id="2247" class="Symbol">}</a> <a id="2249" class="Symbol">→</a> <a id="2251" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2246" class="Bound">m</a> <a id="2253" href="Protocol.Streamlet.Block.html#2075" class="Field Operator">∙block</a> <a id="2260" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2262" class="Bound">b</a> <a id="2264" class="Symbol">→</a> <a id="2266" class="Bound">p</a> <a id="2268" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2270" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2246" class="Bound">m</a> <a id="2272" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a> <a id="2277" class="Symbol">→</a> <a id="2279" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2246" class="Bound">m</a> <a id="2281" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="2283" href="Protocol.Streamlet.Global.Step.html#3371" class="Function">≪db</a>
    <a id="2291" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2238" class="Function">m∉</a> <a id="2294" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2299" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2299" class="Bound">p≡</a> <a id="2302" class="Symbol">=</a> <a id="2304" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1357" class="Function">nfo</a> <a id="2308" class="Symbol">⦃</a> <a id="2310" class="Bound">hp</a> <a id="2313" class="Symbol">⦄</a> <a id="2315" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2320" class="Bound">ready</a> <a id="2326" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2299" class="Bound">p≡</a>

    <a id="2334" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2334" class="Function">m∉′</a> <a id="2338" class="Symbol">:</a> <a id="2340" class="Symbol">∀</a> <a id="2342" class="Symbol">{</a><a id="2343" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2343" class="Bound">m</a><a id="2344" class="Symbol">}</a> <a id="2346" class="Symbol">→</a> <a id="2348" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2343" class="Bound">m</a> <a id="2350" href="Protocol.Streamlet.Block.html#2075" class="Field Operator">∙block</a> <a id="2357" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2359" class="Bound">b′</a> <a id="2362" class="Symbol">→</a> <a id="2364" class="Bound">p</a> <a id="2366" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2368" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2343" class="Bound">m</a> <a id="2370" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a> <a id="2375" class="Symbol">→</a> <a id="2377" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2343" class="Bound">m</a> <a id="2379" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="2381" href="Protocol.Streamlet.Global.Step.html#3371" class="Function">≪db</a>
    <a id="2389" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2334" class="Function">m∉′</a> <a id="2393" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2398" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2398" class="Bound">p≡</a> <a id="2401" class="Symbol">=</a> <a id="2403" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1357" class="Function">nfo</a> <a id="2407" class="Symbol">⦃</a> <a id="2409" class="Bound">hp</a> <a id="2412" class="Symbol">⦄</a> <a id="2414" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2419" class="Bound">ready</a> <a id="2425" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2398" class="Bound">p≡</a>

    <a id="2433" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2433" class="Function">findMessage</a> <a id="2445" class="Symbol">:</a> <a id="2447" class="Symbol">∀</a> <a id="2449" class="Symbol">{</a><a id="2450" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2450" class="Bound">b</a><a id="2451" class="Symbol">}</a> <a id="2453" class="Symbol">→</a> <a id="2455" class="Bound">p</a> <a id="2457" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="2459" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="2467" href="Protocol.Streamlet.Global.Step.html#3371" class="Function">≪db</a> <a id="2471" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2450" class="Bound">b</a> <a id="2473" class="Symbol">→</a>
      <a id="2481" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="2483" class="Symbol">λ</a> <a id="2485" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2485" class="Bound">m</a> <a id="2487" class="Symbol">→</a> <a id="2489" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2485" class="Bound">m</a> <a id="2491" href="Protocol.Streamlet.Block.html#2075" class="Field Operator">∙block</a> <a id="2498" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2500" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2450" class="Bound">b</a> <a id="2502" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2504" class="Bound">p</a> <a id="2506" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2508" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2485" class="Bound">m</a> <a id="2510" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a> <a id="2515" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2517" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2485" class="Bound">m</a> <a id="2519" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="2521" href="Protocol.Streamlet.Global.Step.html#3371" class="Function">≪db</a>
    <a id="2529" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2433" class="Function">findMessage</a> <a id="2541" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2541" class="Bound">p∈b</a>
      <a id="2551" class="Keyword">with</a> <a id="2556" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2556" class="Bound">mᵇ</a> <a id="2559" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2561" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2561" class="Bound">m∈filter</a> <a id="2570" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2572" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> ← <a id="2579" href="Data.List.Membership.Propositional.Properties.html#3880" class="Function">L.Mem.∈-map⁻</a> <a id="2592" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">_∙pid</a> <a id="2598" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2541" class="Bound">p∈b</a>
      <a id="2608" class="Keyword">with</a> <a id="2613" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2613" class="Bound">m∈</a> <a id="2616" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2618" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2618" class="Bound">q</a> ← <a id="2622" href="Data.List.Membership.Propositional.Properties.html#9013" class="Function">L.Mem.∈-filter⁻</a> <a id="2638" class="Symbol">_</a> <a id="2640" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2561" class="Bound">m∈filter</a>
      <a id="2655" class="Symbol">=</a> <a id="2657" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2556" class="Bound">mᵇ</a> <a id="2660" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2662" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="2666" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2618" class="Bound">q</a> <a id="2668" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2670" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2675" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a>  <a id="2678" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2613" class="Bound">m∈</a>

    <a id="2686" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2686" class="Function">p∉</a> <a id="2689" class="Symbol">:</a> <a id="2691" class="Bound">p</a> <a id="2693" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="2695" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="2703" href="Protocol.Streamlet.Global.Step.html#3371" class="Function">≪db</a> <a id="2707" class="Bound">b</a>
    <a id="2713" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2686" class="Function">p∉</a> <a id="2716" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2716" class="Bound">p∈</a>
      <a id="2725" class="Keyword">with</a> <a id="2730" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2730" class="Bound">m</a> <a id="2732" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2734" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2739" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2741" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2746" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2748" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2748" class="Bound">m∈</a> ← <a id="2753" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2433" class="Function">findMessage</a> <a id="2765" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2716" class="Bound">p∈</a>
      <a id="2774" class="Symbol">=</a> <a id="2776" href="Data.Empty.html#1050" class="Function">⊥-elim</a> <a id="2783" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2785" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2238" class="Function">m∉</a> <a id="2788" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2793" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2798" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2748" class="Bound">m∈</a>

    <a id="2806" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2806" class="Function">p∉′</a> <a id="2810" class="Symbol">:</a> <a id="2812" class="Bound">p</a> <a id="2814" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="2816" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="2824" href="Protocol.Streamlet.Global.Step.html#3371" class="Function">≪db</a> <a id="2828" class="Bound">b′</a>
    <a id="2835" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2806" class="Function">p∉′</a> <a id="2839" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2839" class="Bound">p∈</a>
      <a id="2848" class="Keyword">with</a> <a id="2853" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2853" class="Bound">m</a> <a id="2855" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2857" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2862" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2864" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2869" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2871" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2871" class="Bound">m∈</a> ← <a id="2876" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2433" class="Function">findMessage</a> <a id="2888" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2839" class="Bound">p∈</a>
      <a id="2897" class="Symbol">=</a> <a id="2899" href="Data.Empty.html#1050" class="Function">⊥-elim</a> <a id="2906" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2908" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2334" class="Function">m∉′</a> <a id="2912" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2917" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2922" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2871" class="Bound">m∈</a>
  <a id="2927" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a> <a id="2931" class="Symbol">|</a> <a id="2933" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="2937" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2942" class="Symbol">|</a> <a id="2944" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="2946" href="Protocol.Streamlet.Local.Step.html#1710" class="InductiveConstructor">VoteBlock</a> <a id="2956" class="Symbol">{</a><a id="2957" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2957" class="Bound">H</a><a id="2958" class="Symbol">}</a> <a id="2960" class="Symbol">{</a><a id="2961" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2961" class="Bound">txs</a><a id="2964" class="Symbol">}</a> <a id="2966" class="Symbol">_</a> <a id="2968" class="Symbol">_</a> <a id="2970" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2970" class="Bound">ready</a> <a id="2976" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#2976" class="Bound">¬L</a> <a id="2979" class="Symbol">_</a> <a id="2981" class="Symbol">_</a>
    <a id="2987" class="Keyword">rewrite</a> <a id="2995" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>
    <a id="3007" class="Keyword">with</a> <a id="3012" class="Bound">s</a> <a id="3014" class="Symbol">.</a><a id="3015" href="Protocol.Streamlet.Global.State.html#728" class="Field">e-now</a> <a id="3021" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="3023" class="Bound">b</a> <a id="3025" class="Symbol">.</a><a id="3026" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a>
  <a id="3034" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">...</a> <a id="3038" class="Symbol">|</a> <a id="3040" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="3043" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3043" class="Bound">b≢</a>
    <a id="3050" class="Symbol">=</a> <a id="3052" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="3055" class="Symbol">(</a> <a id="3057" href="Protocol.Streamlet.Local.State.html#6029" class="Function">voteIds-∷˘</a>  <a id="3069" class="Symbol">{</a><a id="3070" class="Argument">b</a> <a id="3072" class="Symbol">=</a> <a id="3074" class="Bound">b</a><a id="3075" class="Symbol">}</a>  <a id="3078" class="Symbol">(</a><a id="3079" href="Relation.Binary.PropositionalEquality.Core.html#2329" class="Function">Eq.≢-sym</a> <a id="3088" class="Bound">¬L</a><a id="3090" class="Symbol">)</a>
         <a id="3101" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3103" href="Protocol.Streamlet.Local.State.html#6251" class="Function">voteIds-∷˘′</a> <a id="3115" class="Symbol">{</a><a id="3116" class="Argument">b</a> <a id="3118" class="Symbol">=</a> <a id="3120" class="Bound">b</a><a id="3121" class="Symbol">}</a>  <a id="3124" class="Symbol">(</a><a id="3125" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3043" class="Bound">b≢</a> <a id="3128" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3130" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3135" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a><a id="3140" class="Symbol">)</a> <a id="3142" class="Bound">p∈</a><a id="3144" class="Symbol">)</a>
         <a id="3155" class="Symbol">(</a> <a id="3157" href="Protocol.Streamlet.Local.State.html#6029" class="Function">voteIds-∷˘</a>  <a id="3169" class="Symbol">{</a><a id="3170" class="Argument">b</a> <a id="3172" class="Symbol">=</a> <a id="3174" class="Bound">b′</a><a id="3176" class="Symbol">}</a> <a id="3178" class="Symbol">(</a><a id="3179" href="Relation.Binary.PropositionalEquality.Core.html#2329" class="Function">Eq.≢-sym</a> <a id="3188" class="Bound">¬L</a><a id="3190" class="Symbol">)</a>
         <a id="3201" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3203" href="Protocol.Streamlet.Local.State.html#6251" class="Function">voteIds-∷˘′</a> <a id="3215" class="Symbol">{</a><a id="3216" class="Argument">b</a> <a id="3218" class="Symbol">=</a> <a id="3220" class="Bound">b′</a><a id="3222" class="Symbol">}</a> <a id="3224" class="Symbol">(</a><a id="3225" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3043" class="Bound">b≢</a> <a id="3228" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3230" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3235" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a><a id="3240" class="Symbol">)</a> <a id="3242" class="Bound">p∈′</a><a id="3245" class="Symbol">)</a>
         <a id="3256" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="3263" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">...</a> <a id="3267" class="Symbol">|</a> <a id="3269" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="3273" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3278" class="Symbol">=</a>
    <a id="3284" class="Keyword">let</a> <a id="3288" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3288" class="Bound">≡b</a>  <a id="3292" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3294" class="Symbol">_</a> <a id="3296" class="Symbol">=</a> <a id="3298" href="Protocol.Streamlet.Local.State.html#6379" class="Function">voteIds-head</a> <a id="3311" class="Bound">b</a>  <a id="3314" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4140" class="Function">p∉</a>  <a id="3318" class="Bound">p∈</a>
        <a id="3329" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3329" class="Bound">≡b′</a> <a id="3333" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3335" class="Symbol">_</a> <a id="3337" class="Symbol">=</a> <a id="3339" href="Protocol.Streamlet.Local.State.html#6379" class="Function">voteIds-head</a> <a id="3352" class="Bound">b′</a> <a id="3355" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4238" class="Function">p∉′</a> <a id="3359" class="Bound">p∈′</a>
    <a id="3367" class="Keyword">in</a> <a id="3370" href="Relation.Binary.PropositionalEquality.Core.html#1757" class="Function">trans</a> <a id="3376" class="Symbol">(</a><a id="3377" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="3381" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3288" class="Bound">≡b</a><a id="3383" class="Symbol">)</a> <a id="3385" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3329" class="Bound">≡b′</a>
    <a id="3393" class="Keyword">where</a>
    <a id="3403" class="Keyword">open</a> <a id="3408" href="Protocol.Streamlet.Global.Step.html#3396" class="Module">∣VoteBlock∣</a> <a id="3420" class="Bound">p</a> <a id="3422" class="Symbol">⦃</a> <a id="3424" class="Bound">hp</a> <a id="3427" class="Symbol">⦄</a> <a id="3429" class="Bound">s</a> <a id="3431" class="Bound">H</a> <a id="3433" class="Bound">txs</a>

    <a id="3442" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3442" class="Function">m∉</a> <a id="3445" class="Symbol">:</a> <a id="3447" class="Symbol">∀</a> <a id="3449" class="Symbol">{</a><a id="3450" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3450" class="Bound">m</a><a id="3451" class="Symbol">}</a> <a id="3453" class="Symbol">→</a> <a id="3455" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3450" class="Bound">m</a> <a id="3457" href="Protocol.Streamlet.Block.html#2075" class="Field Operator">∙block</a> <a id="3464" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3466" class="Bound">b</a> <a id="3468" class="Symbol">→</a> <a id="3470" class="Bound">p</a> <a id="3472" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3474" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3450" class="Bound">m</a> <a id="3476" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a> <a id="3481" class="Symbol">→</a> <a id="3483" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3450" class="Bound">m</a> <a id="3485" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="3487" href="Protocol.Streamlet.Global.Step.html#3604" class="Function">≪db</a>
    <a id="3495" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3442" class="Function">m∉</a> <a id="3498" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3503" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3503" class="Bound">p≡</a> <a id="3506" class="Symbol">=</a> <a id="3508" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1357" class="Function">nfo</a> <a id="3512" class="Symbol">⦃</a> <a id="3514" class="Bound">hp</a> <a id="3517" class="Symbol">⦄</a> <a id="3519" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3524" class="Bound">ready</a> <a id="3530" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3503" class="Bound">p≡</a>

    <a id="3538" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3538" class="Function">m∉′</a> <a id="3542" class="Symbol">:</a> <a id="3544" class="Symbol">∀</a> <a id="3546" class="Symbol">{</a><a id="3547" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3547" class="Bound">m</a><a id="3548" class="Symbol">}</a> <a id="3550" class="Symbol">→</a> <a id="3552" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3547" class="Bound">m</a> <a id="3554" href="Protocol.Streamlet.Block.html#2075" class="Field Operator">∙block</a> <a id="3561" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3563" class="Bound">b′</a> <a id="3566" class="Symbol">→</a> <a id="3568" class="Bound">p</a> <a id="3570" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3572" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3547" class="Bound">m</a> <a id="3574" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a> <a id="3579" class="Symbol">→</a> <a id="3581" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3547" class="Bound">m</a> <a id="3583" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="3585" href="Protocol.Streamlet.Global.Step.html#3604" class="Function">≪db</a>
    <a id="3593" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3538" class="Function">m∉′</a> <a id="3597" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3602" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3602" class="Bound">p≡</a> <a id="3605" class="Symbol">=</a> <a id="3607" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1357" class="Function">nfo</a> <a id="3611" class="Symbol">⦃</a> <a id="3613" class="Bound">hp</a> <a id="3616" class="Symbol">⦄</a> <a id="3618" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3623" class="Bound">ready</a> <a id="3629" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3602" class="Bound">p≡</a>

    <a id="3637" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3637" class="Function">findMessage</a> <a id="3649" class="Symbol">:</a> <a id="3651" class="Symbol">∀</a> <a id="3653" class="Symbol">{</a><a id="3654" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3654" class="Bound">b</a><a id="3655" class="Symbol">}</a> <a id="3657" class="Symbol">→</a> <a id="3659" class="Bound">p</a> <a id="3661" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="3663" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="3671" href="Protocol.Streamlet.Global.Step.html#3604" class="Function">≪db</a> <a id="3675" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3654" class="Bound">b</a> <a id="3677" class="Symbol">→</a>
      <a id="3685" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="3687" class="Symbol">λ</a> <a id="3689" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3689" class="Bound">m</a> <a id="3691" class="Symbol">→</a> <a id="3693" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3689" class="Bound">m</a> <a id="3695" href="Protocol.Streamlet.Block.html#2075" class="Field Operator">∙block</a> <a id="3702" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3704" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3654" class="Bound">b</a> <a id="3706" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3708" class="Bound">p</a> <a id="3710" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3712" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3689" class="Bound">m</a> <a id="3714" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a> <a id="3719" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3721" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3689" class="Bound">m</a> <a id="3723" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="3725" href="Protocol.Streamlet.Global.Step.html#3604" class="Function">≪db</a>
    <a id="3733" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3637" class="Function">findMessage</a> <a id="3745" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3745" class="Bound">p∈b</a>
      <a id="3755" class="Keyword">with</a> <a id="3760" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3760" class="Bound">mᵇ</a> <a id="3763" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3765" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3765" class="Bound">m∈filter</a> <a id="3774" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3776" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> ← <a id="3783" href="Data.List.Membership.Propositional.Properties.html#3880" class="Function">L.Mem.∈-map⁻</a> <a id="3796" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">_∙pid</a> <a id="3802" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3745" class="Bound">p∈b</a>
      <a id="3812" class="Keyword">with</a> <a id="3817" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3817" class="Bound">m∈</a> <a id="3820" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3822" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3822" class="Bound">q</a> ← <a id="3826" href="Data.List.Membership.Propositional.Properties.html#9013" class="Function">L.Mem.∈-filter⁻</a> <a id="3842" class="Symbol">_</a> <a id="3844" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3765" class="Bound">m∈filter</a>
      <a id="3859" class="Symbol">=</a> <a id="3861" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3760" class="Bound">mᵇ</a> <a id="3864" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3866" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="3870" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3822" class="Bound">q</a> <a id="3872" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3874" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3879" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a>  <a id="3882" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3817" class="Bound">m∈</a>

    <a id="3890" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3890" class="Function">p∉b</a> <a id="3894" class="Symbol">:</a> <a id="3896" class="Bound">p</a> <a id="3898" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="3900" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="3908" href="Protocol.Streamlet.Global.Step.html#3604" class="Function">≪db</a> <a id="3912" class="Bound">b</a>
    <a id="3918" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3890" class="Function">p∉b</a> <a id="3922" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3922" class="Bound">p∈b</a>
      <a id="3932" class="Keyword">with</a> <a id="3937" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3937" class="Bound">m</a> <a id="3939" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3941" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3946" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3948" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3953" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3955" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3955" class="Bound">m∈</a> ← <a id="3960" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3637" class="Function">findMessage</a> <a id="3972" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3922" class="Bound">p∈b</a>
      <a id="3982" class="Symbol">=</a> <a id="3984" href="Data.Empty.html#1050" class="Function">⊥-elim</a> <a id="3991" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3993" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3442" class="Function">m∉</a> <a id="3996" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4001" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4006" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3955" class="Bound">m∈</a>

    <a id="4014" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4014" class="Function">p∉b′</a> <a id="4019" class="Symbol">:</a> <a id="4021" class="Bound">p</a> <a id="4023" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="4025" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="4033" href="Protocol.Streamlet.Global.Step.html#3604" class="Function">≪db</a> <a id="4037" class="Bound">b′</a>
    <a id="4044" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4014" class="Function">p∉b′</a> <a id="4049" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4049" class="Bound">p∈</a>
      <a id="4058" class="Keyword">with</a> <a id="4063" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4063" class="Bound">m</a> <a id="4065" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4067" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4072" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4074" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4079" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4081" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4081" class="Bound">m∈</a> ← <a id="4086" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3637" class="Function">findMessage</a> <a id="4098" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4049" class="Bound">p∈</a>
      <a id="4107" class="Symbol">=</a> <a id="4109" href="Data.Empty.html#1050" class="Function">⊥-elim</a> <a id="4116" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4118" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3538" class="Function">m∉′</a> <a id="4122" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4127" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4132" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4081" class="Bound">m∈</a>

    <a id="4140" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4140" class="Function">p∉</a> <a id="4143" class="Symbol">:</a> <a id="4145" class="Bound">p</a> <a id="4147" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="4149" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="4157" class="Symbol">(</a><a id="4158" href="Protocol.Streamlet.Global.Step.html#3584" class="Function">Mᵖ</a> <a id="4161" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4163" href="Protocol.Streamlet.Global.Step.html#3604" class="Function">≪db</a><a id="4166" class="Symbol">)</a> <a id="4168" class="Bound">b</a>
    <a id="4174" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4140" class="Function">p∉</a> <a id="4177" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4177" class="Bound">p∈</a> <a id="4180" class="Symbol">=</a> <a id="4182" href="Data.Empty.html#1050" class="Function">⊥-elim</a> <a id="4189" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4191" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#3890" class="Function">p∉b</a> <a id="4195" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4197" href="Protocol.Streamlet.Local.State.html#6029" class="Function">voteIds-∷˘</a> <a id="4208" class="Symbol">{</a><a id="4209" class="Argument">b</a> <a id="4211" class="Symbol">=</a> <a id="4213" class="Bound">b</a><a id="4214" class="Symbol">}</a> <a id="4216" class="Symbol">(</a><a id="4217" href="Relation.Binary.PropositionalEquality.Core.html#2329" class="Function">Eq.≢-sym</a> <a id="4226" class="Bound">¬L</a><a id="4228" class="Symbol">)</a> <a id="4230" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4177" class="Bound">p∈</a>

    <a id="4238" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4238" class="Function">p∉′</a> <a id="4242" class="Symbol">:</a> <a id="4244" class="Bound">p</a> <a id="4246" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="4248" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="4256" class="Symbol">(</a><a id="4257" href="Protocol.Streamlet.Global.Step.html#3584" class="Function">Mᵖ</a> <a id="4260" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4262" href="Protocol.Streamlet.Global.Step.html#3604" class="Function">≪db</a><a id="4265" class="Symbol">)</a> <a id="4267" class="Bound">b′</a>
    <a id="4274" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4238" class="Function">p∉′</a> <a id="4278" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4278" class="Bound">p∈</a> <a id="4281" class="Symbol">=</a> <a id="4283" href="Data.Empty.html#1050" class="Function">⊥-elim</a> <a id="4290" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4292" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4014" class="Function">p∉b′</a> <a id="4297" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4299" href="Protocol.Streamlet.Local.State.html#6029" class="Function">voteIds-∷˘</a> <a id="4310" class="Symbol">{</a><a id="4311" class="Argument">b</a> <a id="4313" class="Symbol">=</a> <a id="4315" class="Bound">b′</a><a id="4317" class="Symbol">}</a> <a id="4319" class="Symbol">(</a><a id="4320" href="Relation.Binary.PropositionalEquality.Core.html#2329" class="Function">Eq.≢-sym</a> <a id="4329" class="Bound">¬L</a><a id="4331" class="Symbol">)</a> <a id="4333" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4278" class="Bound">p∈</a>
  <a id="4338" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a> <a id="4342" class="Symbol">|</a> <a id="4344" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="4348" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4353" class="Symbol">|</a> <a id="4355" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="4357" href="Protocol.Streamlet.Local.Step.html#2361" class="InductiveConstructor">RegisterVote</a> <a id="4370" class="Symbol">{</a><a id="4371" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4371" class="Bound">sb</a><a id="4373" class="Symbol">}</a> <a id="4375" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4375" class="Bound">m∈inbox</a> <a id="4383" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4383" class="Bound">sb∉db</a>
    <a id="4393" class="Keyword">rewrite</a> <a id="4401" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>
    <a id="4413" class="Symbol">=</a> <a id="4415" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="4418" class="Symbol">(</a><a id="4419" href="Protocol.Streamlet.Local.State.html#6029" class="Function">voteIds-∷˘</a> <a id="4430" class="Symbol">{</a><a id="4431" class="Argument">b</a> <a id="4433" class="Symbol">=</a> <a id="4435" class="Bound">b</a><a id="4436" class="Symbol">}</a>  <a id="4439" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4595" class="Function">p≢</a> <a id="4442" class="Bound">p∈</a><a id="4444" class="Symbol">)</a>
         <a id="4455" class="Symbol">(</a><a id="4456" href="Protocol.Streamlet.Local.State.html#6029" class="Function">voteIds-∷˘</a> <a id="4467" class="Symbol">{</a><a id="4468" class="Argument">b</a> <a id="4470" class="Symbol">=</a> <a id="4472" class="Bound">b′</a><a id="4474" class="Symbol">}</a> <a id="4476" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4595" class="Function">p≢</a> <a id="4479" class="Bound">p∈′</a><a id="4482" class="Symbol">)</a>
         <a id="4493" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="4502" class="Keyword">where</a>
    <a id="4512" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4512" class="Function">m∉</a> <a id="4515" class="Symbol">:</a> <a id="4517" href="Protocol.Streamlet.Message.html#329" class="InductiveConstructor">Vote</a> <a id="4522" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4371" class="Bound">sb</a> <a id="4525" href="Data.List.Membership.Setoid.html#999" class="Function Operator">∉</a> <a id="4527" class="Symbol">(</a><a id="4528" class="Bound">s</a> <a id="4530" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="4532" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1288" class="Bound">p′</a><a id="4534" class="Symbol">)</a> <a id="4536" class="Symbol">.</a><a id="4537" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a>
    <a id="4544" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4512" class="Function">m∉</a> <a id="4547" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4547" class="Bound">m∈</a> <a id="4550" class="Symbol">=</a> <a id="4552" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4383" class="Bound">sb∉db</a> <a id="4558" class="Symbol">(</a><a id="4559" href="Data.List.Membership.Propositional.Properties.html#3766" class="Function">L.Mem.∈-map⁺</a> <a id="4572" href="Protocol.Streamlet.Block.html#2419" class="Field Operator">_∙signedBlock</a> <a id="4586" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4547" class="Bound">m∈</a><a id="4588" class="Symbol">)</a>

    <a id="4595" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4595" class="Function">p≢</a> <a id="4598" class="Symbol">:</a> <a id="4600" class="Symbol">(</a><a id="4601" href="Protocol.Streamlet.Message.html#329" class="InductiveConstructor">Vote</a> <a id="4606" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4371" class="Bound">sb</a><a id="4608" class="Symbol">)</a> <a id="4610" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a> <a id="4615" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="4617" class="Bound">p</a>
    <a id="4623" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4595" class="Function">p≢</a> <a id="4626" class="Keyword">with</a> <a id="4631" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4371" class="Bound">sb</a> <a id="4634" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a> <a id="4639" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="4641" class="Bound">p</a>
    <a id="4647" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4595" class="Function">...</a> <a id="4651" class="Symbol">|</a> <a id="4653" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="4657" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4657" class="Bound">p≡</a> <a id="4660" class="Symbol">=</a> <a id="4662" href="Data.Empty.html#1050" class="Function">⊥-elim</a> <a id="4669" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4671" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4512" class="Function">m∉</a> <a id="4674" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4676" href="Protocol.Streamlet.Invariants.Unforgeability.html#582" class="Function">unforgeability</a> <a id="4691" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#871" class="Bound">Rs</a> <a id="4694" class="Symbol">⦃</a> <a id="4696" class="Bound">hp</a> <a id="4699" class="Symbol">⦄</a> <a id="4701" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4375" class="Bound">m∈inbox</a> <a id="4709" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4711" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="4715" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4657" class="Bound">p≡</a>
    <a id="4722" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4595" class="Function">...</a> <a id="4726" class="Symbol">|</a> <a id="4728" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="4732" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4732" class="Bound">p≢</a> <a id="4735" class="Symbol">=</a> <a id="4737" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4732" class="Bound">p≢</a>
  <a id="4742" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#1386" class="Function">QED</a> <a id="4746" class="Symbol">|</a> <a id="4748" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="4752" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4757" class="Symbol">|</a> <a id="4759" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="4761" href="Protocol.Streamlet.Local.Step.html#2751" class="InductiveConstructor">FinalizeBlock</a> <a id="4775" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4775" class="Bound">ch</a> <a id="4778" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4778" class="Bound">b</a> <a id="4780" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4780" class="Bound">x</a> <a id="4782" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4782" class="Bound">x₁</a>
    <a id="4789" class="Keyword">rewrite</a> <a id="4797" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>
    <a id="4809" class="Symbol">=</a> <a id="4811" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="4814" class="Bound">p∈</a> <a id="4817" class="Bound">p∈′</a> <a id="4821" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="4826" class="Symbol">...</a> <a id="4830" class="Symbol">|</a> <a id="4832" href="Protocol.Streamlet.Global.Step.html#2028" class="InductiveConstructor">DishonestLocalStep</a> <a id="4851" class="Symbol">{</a><a id="4852" class="Argument">p</a> <a id="4854" class="Symbol">=</a> <a id="4856" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4856" class="Bound">p′</a><a id="4858" class="Symbol">}{</a><a id="4860" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4860" class="Bound">mm</a><a id="4862" class="Symbol">}</a> <a id="4864" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4864" class="Bound">¬hp′</a> <a id="4869" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4869" class="Bound">h⇒m∈</a>
  <a id="4876" class="Symbol">=</a> <a id="4878" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="4886" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#896" class="Bound">IH</a> <a id="4889" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4952" class="Function">≪p∈</a> <a id="4893" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="4900" class="Keyword">where</a>
  <a id="4908" class="Keyword">open</a> <a id="4913" href="Protocol.Streamlet.Global.Step.html#5375" class="Module">∣DishonestLocalStep∣</a> <a id="4934" class="Bound">p</a> <a id="4936" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4856" class="Bound">p′</a> <a id="4939" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4864" class="Bound">¬hp′</a> <a id="4944" class="Bound">s</a> <a id="4946" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4860" class="Bound">mm</a>

  <a id="4952" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4952" class="Function">≪p∈</a> <a id="4956" class="Symbol">:</a> <a id="4958" class="Bound">p</a> <a id="4960" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="4962" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="4970" class="Symbol">((</a><a id="4972" class="Bound">s</a> <a id="4974" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="4976" class="Bound">p</a><a id="4977" class="Symbol">)</a> <a id="4979" class="Symbol">.</a><a id="4980" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a><a id="4982" class="Symbol">)</a> <a id="4984" class="Bound">b</a>
      <a id="4992" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4994" class="Bound">p</a> <a id="4996" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="4998" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="5006" class="Symbol">((</a><a id="5008" class="Bound">s</a> <a id="5010" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="5012" class="Bound">p</a><a id="5013" class="Symbol">)</a> <a id="5015" class="Symbol">.</a><a id="5016" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a><a id="5018" class="Symbol">)</a> <a id="5020" class="Bound">b′</a>
  <a id="5025" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#4952" class="Function">≪p∈</a> <a id="5029" class="Keyword">rewrite</a> <a id="5037" href="Protocol.Streamlet.Global.Step.html#5539" class="Function">db≡</a> <a id="5041" class="Symbol">=</a> <a id="5043" class="Bound">p∈</a> <a id="5046" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5048" class="Bound">p∈′</a>
</pre>
<pre class="Agda"><a id="VotedOnlyOncePerEpoch"></a><a id="5066" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5066" class="Function">VotedOnlyOncePerEpoch</a> <a id="5088" class="Symbol">:</a> <a id="5090" href="Protocol.Streamlet.Global.Traces.html#966" class="Function">StateProperty</a>
<a id="5104" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5066" class="Function">VotedOnlyOncePerEpoch</a> <a id="5126" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5126" class="Bound">s</a> <a id="5128" class="Symbol">=</a> <a id="5130" class="Symbol">∀</a> <a id="5132" class="Symbol">{</a><a id="5133" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5133" class="Bound">p</a> <a id="5135" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5135" class="Bound">p′</a><a id="5137" class="Symbol">}</a> <a id="5139" class="Symbol">⦃</a> <a id="5141" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5141" class="Bound">_</a> <a id="5143" class="Symbol">:</a> <a id="5145" href="Protocol.Streamlet.Assumptions.html#1062" class="Field">Honest</a> <a id="5152" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5133" class="Bound">p</a> <a id="5154" class="Symbol">⦄</a> <a id="5156" class="Symbol">⦃</a> <a id="5158" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5158" class="Bound">_</a> <a id="5160" class="Symbol">:</a> <a id="5162" href="Protocol.Streamlet.Assumptions.html#1062" class="Field">Honest</a> <a id="5169" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5135" class="Bound">p′</a> <a id="5172" class="Symbol">⦄</a> <a id="5174" class="Symbol">→</a>
  <a id="5178" class="Keyword">let</a> <a id="5182" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5182" class="Bound">ms</a> <a id="5185" class="Symbol">=</a> <a id="5187" class="Symbol">(</a><a id="5188" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5126" class="Bound">s</a> <a id="5190" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="5192" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5133" class="Bound">p</a><a id="5193" class="Symbol">)</a> <a id="5195" class="Symbol">.</a><a id="5196" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a> <a id="5199" class="Keyword">in</a>
  <a id="5204" class="Symbol">∀</a> <a id="5206" class="Symbol">{</a><a id="5207" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5207" class="Bound">b</a> <a id="5209" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5209" class="Bound">b′</a><a id="5211" class="Symbol">}</a> <a id="5213" class="Symbol">→</a>
  <a id="5217" href="Prelude.InferenceRules.html#56097" class="Function Operator">∙</a> <a id="5219" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5135" class="Bound">p′</a> <a id="5222" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="5224" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="5232" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5182" class="Bound">ms</a> <a id="5235" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5207" class="Bound">b</a>
  <a id="5239" href="Prelude.InferenceRules.html#56028" class="Function Operator">∙</a> <a id="5241" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5135" class="Bound">p′</a> <a id="5244" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="5246" href="Protocol.Streamlet.Local.State.html#2919" class="Function">voteIds</a> <a id="5254" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5182" class="Bound">ms</a> <a id="5257" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5209" class="Bound">b′</a>
  <a id="5262" href="Prelude.InferenceRules.html#56028" class="Function Operator">∙</a> <a id="5264" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5207" class="Bound">b</a> <a id="5266" class="Symbol">.</a><a id="5267" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a> <a id="5273" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5275" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5209" class="Bound">b′</a> <a id="5278" class="Symbol">.</a><a id="5279" href="Protocol.Streamlet.Block.html#332" class="Field">epoch</a>
    <a id="5289" href="Prelude.InferenceRules.html#14094" class="Function Operator">────────────────────</a>
    <a id="5314" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5207" class="Bound">b</a> <a id="5316" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5318" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5209" class="Bound">b′</a>

<a id="votedOnlyOncePerEpoch"></a><a id="5322" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5322" class="Function">votedOnlyOncePerEpoch</a> <a id="5344" class="Symbol">:</a> <a id="5346" href="Prelude.Closures.html#3717" class="Function">Invariant</a> <a id="5356" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5066" class="Function">VotedOnlyOncePerEpoch</a>
<a id="5378" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5322" class="Function">votedOnlyOncePerEpoch</a> <a id="5400" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5400" class="Bound">Rs</a> <a id="5403" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5403" class="Bound">p∈</a> <a id="5406" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5406" class="Bound">p∈′</a> <a id="5410" class="Symbol">=</a>
  <a id="5414" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#599" class="Function">votedOnlyOncePerEpoch¹</a> <a id="5437" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5400" class="Bound">Rs</a> <a id="5440" class="Symbol">(</a><a id="5441" href="Protocol.Streamlet.Invariants.Votes.html#1250" class="Function">messageSharing</a> <a id="5456" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5400" class="Bound">Rs</a> <a id="5459" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5403" class="Bound">p∈</a><a id="5461" class="Symbol">)</a> <a id="5463" class="Symbol">(</a><a id="5464" href="Protocol.Streamlet.Invariants.Votes.html#1250" class="Function">messageSharing</a> <a id="5479" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5400" class="Bound">Rs</a> <a id="5482" href="Protocol.Streamlet.Invariants.VotedOnlyOnce.html#5406" class="Bound">p∈′</a><a id="5485" class="Symbol">)</a>
</pre>
</body>
</html>
