<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Protocol.Streamlet.Invariants.Unforgeability</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="Agda.css" />
</head>
<body>
<!--
<pre class="Agda"><a id="14" class="Symbol">{-#</a> <a id="18" class="Keyword">OPTIONS</a> <a id="26" class="Pragma">--safe</a> <a id="33" class="Symbol">#-}</a>
<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Prelude.html" class="Module">Prelude</a>
<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Hash.html" class="Module">Hash</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Protocol.Streamlet.Assumptions.html" class="Module">Protocol.Streamlet.Assumptions</a>

<a id="119" class="Keyword">module</a> <a id="126" href="Protocol.Streamlet.Invariants.Unforgeability.html" class="Module">Protocol.Streamlet.Invariants.Unforgeability</a> <a id="171" class="Symbol">(</a><a id="172" href="Protocol.Streamlet.Invariants.Unforgeability.html#172" class="Bound">⋯</a> <a id="174" class="Symbol">:</a> <a id="176" class="Symbol">_)</a> <a id="179" class="Symbol">(</a><a id="180" class="Keyword">open</a> <a id="185" href="Protocol.Streamlet.Assumptions.html#222" class="Module">Assumptions</a> <a id="197" href="Protocol.Streamlet.Invariants.Unforgeability.html#172" class="Bound">⋯</a><a id="198" class="Symbol">)</a> <a id="200" class="Keyword">where</a>

<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Protocol.Streamlet.html" class="Module">Protocol.Streamlet</a> <a id="238" href="Protocol.Streamlet.Invariants.Unforgeability.html#172" class="Bound">⋯</a>

<a id="241" class="Keyword">open</a> <a id="246" class="Keyword">import</a> <a id="253" href="Protocol.Streamlet.Invariants.History.html" class="Module">Protocol.Streamlet.Invariants.History</a> <a id="291" href="Protocol.Streamlet.Invariants.Unforgeability.html#172" class="Bound">⋯</a>
</pre>-->
<p>Messages in the inbox of an honest participant signed by themselves
are in that participants′ local database.</p>
<pre class="Agda"><a id="Unforgeability"></a><a id="421" href="Protocol.Streamlet.Invariants.Unforgeability.html#421" class="Function">Unforgeability</a> <a id="436" class="Symbol">:</a> <a id="438" href="Protocol.Streamlet.Global.Traces.html#966" class="Function">StateProperty</a>
<a id="452" href="Protocol.Streamlet.Invariants.Unforgeability.html#421" class="Function">Unforgeability</a> <a id="467" href="Protocol.Streamlet.Invariants.Unforgeability.html#467" class="Bound">s</a> <a id="469" class="Symbol">=</a> <a id="471" class="Symbol">∀</a> <a id="473" class="Symbol">{</a><a id="474" href="Protocol.Streamlet.Invariants.Unforgeability.html#474" class="Bound">p</a> <a id="476" href="Protocol.Streamlet.Invariants.Unforgeability.html#476" class="Bound">m</a><a id="477" class="Symbol">}</a> <a id="479" class="Symbol">⦃</a> <a id="481" href="Protocol.Streamlet.Invariants.Unforgeability.html#481" class="Bound">_</a> <a id="483" class="Symbol">:</a> <a id="485" href="Protocol.Streamlet.Assumptions.html#1062" class="Field">Honest</a> <a id="492" href="Protocol.Streamlet.Invariants.Unforgeability.html#474" class="Bound">p</a> <a id="494" class="Symbol">⦄</a> <a id="496" class="Symbol">→</a>
  <a id="500" href="Prelude.InferenceRules.html#56097" class="Function Operator">∙</a> <a id="502" href="Protocol.Streamlet.Invariants.Unforgeability.html#476" class="Bound">m</a> <a id="504" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="506" class="Symbol">(</a><a id="507" href="Protocol.Streamlet.Invariants.Unforgeability.html#467" class="Bound">s</a> <a id="509" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="511" href="Protocol.Streamlet.Invariants.Unforgeability.html#474" class="Bound">p</a><a id="512" class="Symbol">)</a> <a id="514" class="Symbol">.</a><a id="515" href="Protocol.Streamlet.Local.State.html#990" class="Field">inbox</a>
  <a id="523" href="Prelude.InferenceRules.html#56028" class="Function Operator">∙</a> <a id="525" href="Protocol.Streamlet.Invariants.Unforgeability.html#474" class="Bound">p</a> <a id="527" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="529" href="Protocol.Streamlet.Invariants.Unforgeability.html#476" class="Bound">m</a> <a id="531" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a>
    <a id="540" href="Prelude.InferenceRules.html#14094" class="Function Operator">────────────────────</a>
    <a id="565" href="Protocol.Streamlet.Invariants.Unforgeability.html#476" class="Bound">m</a> <a id="567" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="569" class="Symbol">(</a><a id="570" href="Protocol.Streamlet.Invariants.Unforgeability.html#467" class="Bound">s</a> <a id="572" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="574" href="Protocol.Streamlet.Invariants.Unforgeability.html#474" class="Bound">p</a><a id="575" class="Symbol">)</a> <a id="577" class="Symbol">.</a><a id="578" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a>

<a id="unforgeability"></a><a id="582" href="Protocol.Streamlet.Invariants.Unforgeability.html#582" class="Function">unforgeability</a> <a id="597" class="Symbol">:</a> <a id="599" href="Prelude.Closures.html#3717" class="Function">Invariant</a> <a id="609" href="Protocol.Streamlet.Invariants.Unforgeability.html#421" class="Function">Unforgeability</a>
<a id="624" href="Protocol.Streamlet.Invariants.Unforgeability.html#582" class="Function">unforgeability</a> <a id="639" class="Symbol">(_</a> <a id="642" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="644" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="649" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="651" class="Symbol">(</a><a id="652" class="DottedPattern Symbol">._</a> <a id="655" href="Prelude.Closures.html#689" class="InductiveConstructor Operator">∎</a><a id="656" class="Symbol">))</a> <a id="659" class="Symbol">{</a><a id="660" href="Protocol.Streamlet.Invariants.Unforgeability.html#660" class="Bound">p</a><a id="661" class="Symbol">}</a> <a id="663" href="Protocol.Streamlet.Invariants.Unforgeability.html#663" class="Bound">m∈</a> <a id="666" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="673" class="Keyword">rewrite</a> <a id="681" class="Keyword">let</a> <a id="685" class="Keyword">open</a> <a id="690" href="Protocol.Streamlet.Global.Step.html#3796" class="Module">∣Base∣</a> <a id="697" href="Protocol.Streamlet.Invariants.Unforgeability.html#660" class="Bound">p</a> <a id="699" class="Keyword">in</a> <a id="702" href="Protocol.Streamlet.Global.Step.html#3830" class="Function">lookup✓</a>
  <a id="712" class="Symbol">=</a> <a id="714" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="719" href="Protocol.Streamlet.Invariants.Unforgeability.html#663" class="Bound">m∈</a> <a id="722" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="725" class="Symbol">λ</a> <a id="727" class="Symbol">()</a>
<a id="730" href="Protocol.Streamlet.Invariants.Unforgeability.html#582" class="Function">unforgeability</a> <a id="745" class="Symbol">{</a><a id="746" href="Protocol.Streamlet.Invariants.Unforgeability.html#746" class="Bound">s′</a><a id="748" class="Symbol">}</a> <a id="750" class="Symbol">(_</a> <a id="753" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="755" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="760" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="762" class="Symbol">(_</a> <a id="765" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">⟨</a> <a id="767" href="Protocol.Streamlet.Invariants.Unforgeability.html#767" class="Bound">s→</a> <a id="770" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">∣</a> <a id="772" href="Protocol.Streamlet.Invariants.Unforgeability.html#772" class="Bound">s</a> <a id="774" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">⟩←—</a> <a id="778" href="Protocol.Streamlet.Invariants.Unforgeability.html#778" class="Bound">tr</a><a id="780" class="Symbol">))</a>
  <a id="785" class="Symbol">{</a><a id="786" href="Protocol.Streamlet.Invariants.Unforgeability.html#786" class="Bound">p</a><a id="787" class="Symbol">}</a> <a id="789" class="Symbol">{</a><a id="790" href="Protocol.Streamlet.Invariants.Unforgeability.html#790" class="Bound">m</a><a id="791" class="Symbol">}</a> <a id="793" href="Protocol.Streamlet.Invariants.Unforgeability.html#793" class="Bound">m∈</a> <a id="796" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="803" class="Keyword">with</a> <a id="808" href="Protocol.Streamlet.Invariants.Unforgeability.html#808" class="Bound">Rs</a> ← <a id="813" href="Data.Product.Base.html#1932" class="Function Operator">-,</a> <a id="816" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="821" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="823" href="Protocol.Streamlet.Invariants.Unforgeability.html#778" class="Bound">tr</a>
  <a id="828" class="Keyword">with</a> <a id="833" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> ← <a id="838" class="Symbol">(λ</a> <a id="841" class="Symbol">(</a><a id="842" href="Protocol.Streamlet.Invariants.Unforgeability.html#842" class="Bound">m∈</a> <a id="845" class="Symbol">:</a> <a id="847" href="Protocol.Streamlet.Invariants.Unforgeability.html#790" class="Bound">m</a> <a id="849" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="851" class="Symbol">(</a><a id="852" href="Protocol.Streamlet.Invariants.Unforgeability.html#772" class="Bound">s</a> <a id="854" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="856" href="Protocol.Streamlet.Invariants.Unforgeability.html#786" class="Bound">p</a><a id="857" class="Symbol">)</a> <a id="859" class="Symbol">.</a><a id="860" href="Protocol.Streamlet.Local.State.html#990" class="Field">inbox</a><a id="865" class="Symbol">)</a> <a id="867" class="Symbol">→</a> <a id="869" href="Protocol.Streamlet.Invariants.Unforgeability.html#582" class="Function">unforgeability</a> <a id="884" href="Protocol.Streamlet.Invariants.Unforgeability.html#808" class="Bound">Rs</a> <a id="887" href="Protocol.Streamlet.Invariants.Unforgeability.html#842" class="Bound">m∈</a><a id="889" class="Symbol">)</a>
  <a id="893" class="Keyword">with</a> <a id="898" href="Protocol.Streamlet.Invariants.Unforgeability.html#767" class="Bound">s→</a>
<a id="901" class="Symbol">...</a> <a id="905" class="Symbol">|</a> <a id="907" href="Protocol.Streamlet.Global.Step.html#2366" class="InductiveConstructor">Deliver</a> <a id="915" class="Symbol">{</a><a id="916" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">[</a> <a id="918" href="Protocol.Streamlet.Invariants.Unforgeability.html#918" class="Bound">p′</a> <a id="921" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">∣</a> <a id="923" href="Protocol.Streamlet.Invariants.Unforgeability.html#923" class="Bound">m′</a> <a id="926" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">⟩</a><a id="927" class="Symbol">}</a> <a id="929" href="Protocol.Streamlet.Invariants.Unforgeability.html#929" class="Bound">env∈</a>
  <a id="936" class="Symbol">=</a> <a id="938" href="Protocol.Streamlet.Invariants.Unforgeability.html#979" class="Function">QED</a>
  <a id="944" class="Keyword">where</a>
  <a id="952" class="Keyword">open</a> <a id="957" href="Protocol.Streamlet.Global.Step.html#3985" class="Module">∣Deliver∣</a> <a id="967" class="Bound">p</a> <a id="969" class="Bound">s</a> <a id="971" href="Protocol.Streamlet.Invariants.Unforgeability.html#929" class="Bound">env∈</a>

  <a id="979" href="Protocol.Streamlet.Invariants.Unforgeability.html#979" class="Function">QED</a> <a id="983" class="Symbol">:</a> <a id="985" class="Bound">m</a> <a id="987" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="989" class="Symbol">(</a><a id="990" class="Bound">s′</a> <a id="993" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="995" class="Bound">p</a><a id="996" class="Symbol">)</a> <a id="998" class="Symbol">.</a><a id="999" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a>
  <a id="1004" href="Protocol.Streamlet.Invariants.Unforgeability.html#979" class="Function">QED</a>
    <a id="1012" class="Keyword">with</a> <a id="1017" href="Protocol.Streamlet.Assumptions.html#1192" class="Function">honest?</a> <a id="1025" href="Protocol.Streamlet.Invariants.Unforgeability.html#918" class="Bound">p′</a>
  <a id="1030" href="Protocol.Streamlet.Invariants.Unforgeability.html#979" class="Function">...</a> <a id="1034" class="Symbol">|</a> <a id="1036" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="1039" class="Symbol">_</a> <a id="1041" class="Symbol">=</a> <a id="1043" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="1046" class="Bound">m∈</a> <a id="1049" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1056" href="Protocol.Streamlet.Invariants.Unforgeability.html#979" class="Function">...</a> <a id="1060" class="Symbol">|</a> <a id="1062" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1066" href="Protocol.Streamlet.Invariants.Unforgeability.html#1066" class="Bound">hp′</a>
    <a id="1074" class="Keyword">with</a> <a id="1079" class="Bound">p</a> <a id="1081" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1083" href="Protocol.Streamlet.Invariants.Unforgeability.html#918" class="Bound">p′</a>
  <a id="1088" class="Symbol">...</a> <a id="1092" class="Symbol">|</a> <a id="1094" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="1097" href="Protocol.Streamlet.Invariants.Unforgeability.html#1097" class="Bound">p≢</a> <a id="1100" class="Keyword">rewrite</a> <a id="1108" href="Protocol.Streamlet.Global.Step.html#4236" class="Function">lookup✖</a> <a id="1116" class="Symbol">⦃</a> <a id="1118" class="Bound">hp′</a> <a id="1122" class="Symbol">⦄</a> <a id="1124" href="Protocol.Streamlet.Invariants.Unforgeability.html#1097" class="Bound">p≢</a> <a id="1127" class="Symbol">=</a> <a id="1129" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="1132" class="Bound">m∈</a> <a id="1135" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1142" class="Symbol">...</a> <a id="1146" class="Symbol">|</a> <a id="1148" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1152" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1157" class="Keyword">rewrite</a> <a id="1165" href="Protocol.Streamlet.Global.Step.html#4169" class="Function">lookup✓</a> <a id="1173" class="Symbol">⦃</a> <a id="1175" href="Function.Base.html#4736" class="Function">it</a> <a id="1178" class="Symbol">⦄</a>
    <a id="1184" class="Keyword">with</a> <a id="1189" class="Bound">m</a> <a id="1191" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1193" href="Protocol.Streamlet.Invariants.Unforgeability.html#923" class="Bound">m′</a>
  <a id="1198" class="Symbol">...</a> <a id="1202" class="Symbol">|</a> <a id="1204" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1208" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1213" class="Symbol">=</a> <a id="1215" href="Protocol.Streamlet.Invariants.History.html#506" class="Function">historySound</a> <a id="1228" href="Protocol.Streamlet.Invariants.Unforgeability.html#808" class="Bound">Rs</a> <a id="1231" class="Symbol">(</a><a id="1232" href="Protocol.Streamlet.Invariants.History.html#2446" class="Function">networkComplete</a> <a id="1248" href="Protocol.Streamlet.Invariants.Unforgeability.html#808" class="Bound">Rs</a> <a id="1251" href="Protocol.Streamlet.Invariants.Unforgeability.html#929" class="Bound">env∈</a><a id="1255" class="Symbol">)</a> <a id="1257" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1264" class="Symbol">...</a> <a id="1268" class="Symbol">|</a> <a id="1270" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="1273" href="Protocol.Streamlet.Invariants.Unforgeability.html#1273" class="Bound">m≢</a>
    <a id="1280" class="Keyword">with</a> <a id="1285" href="Prelude.Lists.html#4003" class="Function">∈-∷ʳ⁻</a> <a id="1291" class="Bound">m∈</a>
  <a id="1296" class="Symbol">...</a> <a id="1300" class="Symbol">|</a> <a id="1302" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1307" href="Protocol.Streamlet.Invariants.Unforgeability.html#1307" class="Bound">m∈</a> <a id="1310" class="Symbol">=</a> <a id="1312" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="1315" href="Protocol.Streamlet.Invariants.Unforgeability.html#1307" class="Bound">m∈</a> <a id="1318" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1325" class="Symbol">...</a> <a id="1329" class="Symbol">|</a> <a id="1331" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1336" href="Protocol.Streamlet.Invariants.Unforgeability.html#1336" class="Bound">m≡</a> <a id="1339" class="Symbol">=</a> <a id="1341" href="Data.Empty.html#1050" class="Function">⊥-elim</a> <a id="1348" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1350" class="Bound">m≢</a> <a id="1353" href="Protocol.Streamlet.Invariants.Unforgeability.html#1336" class="Bound">m≡</a>
<a id="1356" class="Symbol">...</a> <a id="1360" class="Symbol">|</a> <a id="1362" href="Protocol.Streamlet.Global.Step.html#2518" class="InductiveConstructor">AdvanceEpoch</a>
  <a id="1377" class="Keyword">rewrite</a> <a id="1385" class="Keyword">let</a> <a id="1389" class="Keyword">open</a> <a id="1394" href="Protocol.Streamlet.Global.Step.html#3883" class="Module">∣AdvanceEpoch∣</a> <a id="1409" class="Bound">p</a> <a id="1411" class="Bound">s</a> <a id="1413" class="Keyword">in</a> <a id="1416" href="Protocol.Streamlet.Global.Step.html#3927" class="Function">lookup✓</a>
  <a id="1426" class="Symbol">=</a> <a id="1428" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="1431" class="Bound">m∈</a> <a id="1434" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="1439" class="Symbol">...</a> <a id="1443" class="Symbol">|</a> <a id="1445" href="Protocol.Streamlet.Global.Step.html#2625" class="InductiveConstructor">Drop</a> <a id="1450" class="Symbol">_</a>
  <a id="1454" class="Symbol">=</a> <a id="1456" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="1459" class="Bound">m∈</a> <a id="1462" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="1467" class="Symbol">...</a> <a id="1471" class="Symbol">|</a> <a id="1473" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="1483" class="Symbol">{</a><a id="1484" class="Argument">p</a> <a id="1486" class="Symbol">=</a> <a id="1488" href="Protocol.Streamlet.Invariants.Unforgeability.html#1488" class="Bound">p′</a><a id="1490" class="Symbol">}{</a><a id="1492" href="Protocol.Streamlet.Invariants.Unforgeability.html#1492" class="Bound">mm</a><a id="1494" class="Symbol">}{</a><a id="1496" href="Protocol.Streamlet.Invariants.Unforgeability.html#1496" class="Bound">ls′</a><a id="1499" class="Symbol">}</a> <a id="1501" href="Protocol.Streamlet.Invariants.Unforgeability.html#1501" class="Bound">ls→</a>
  <a id="1507" class="Symbol">=</a> <a id="1509" href="Protocol.Streamlet.Invariants.Unforgeability.html#1557" class="Function">QED</a>
  <a id="1515" class="Keyword">where</a>
  <a id="1523" class="Keyword">open</a> <a id="1528" href="Protocol.Streamlet.Global.Step.html#4791" class="Module">∣LocalStep∣</a> <a id="1540" class="Bound">p</a> <a id="1542" href="Protocol.Streamlet.Invariants.Unforgeability.html#1488" class="Bound">p′</a> <a id="1545" class="Bound">s</a> <a id="1547" href="Protocol.Streamlet.Invariants.Unforgeability.html#1492" class="Bound">mm</a> <a id="1550" href="Protocol.Streamlet.Invariants.Unforgeability.html#1496" class="Bound">ls′</a>

  <a id="1557" href="Protocol.Streamlet.Invariants.Unforgeability.html#1557" class="Function">QED</a> <a id="1561" class="Symbol">:</a> <a id="1563" class="Bound">m</a> <a id="1565" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="1567" class="Symbol">(</a><a id="1568" class="Bound">s′</a> <a id="1571" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="1573" class="Bound">p</a><a id="1574" class="Symbol">)</a> <a id="1576" class="Symbol">.</a><a id="1577" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a>
  <a id="1582" href="Protocol.Streamlet.Invariants.Unforgeability.html#1557" class="Function">QED</a> <a id="1586" class="Keyword">with</a> <a id="1591" class="Bound">p</a> <a id="1593" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1595" href="Protocol.Streamlet.Invariants.Unforgeability.html#1488" class="Bound">p′</a>
  <a id="1600" href="Protocol.Streamlet.Invariants.Unforgeability.html#1557" class="Function">QED</a> <a id="1604" class="Symbol">|</a> <a id="1606" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="1609" href="Protocol.Streamlet.Invariants.Unforgeability.html#1609" class="Bound">p≢</a> <a id="1612" class="Keyword">rewrite</a> <a id="1620" href="Protocol.Streamlet.Global.Step.html#5246" class="Function">lookup✖′</a> <a id="1629" href="Protocol.Streamlet.Invariants.Unforgeability.html#1609" class="Bound">p≢</a> <a id="1632" class="Symbol">=</a> <a id="1634" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="1637" href="Protocol.Streamlet.Invariants.Unforgeability.html#1665" class="Function">m∈inbox✖</a> <a id="1646" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1655" class="Keyword">where</a>
    <a id="1665" href="Protocol.Streamlet.Invariants.Unforgeability.html#1665" class="Function">m∈inbox✖</a> <a id="1674" class="Symbol">:</a> <a id="1676" class="Bound">m</a> <a id="1678" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="1680" class="Symbol">(</a><a id="1681" class="Bound">s</a> <a id="1683" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="1685" class="Bound">m</a> <a id="1687" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a><a id="1691" class="Symbol">)</a> <a id="1693" class="Symbol">.</a><a id="1694" href="Protocol.Streamlet.Local.State.html#990" class="Field">inbox</a>
    <a id="1704" href="Protocol.Streamlet.Invariants.Unforgeability.html#1665" class="Function">m∈inbox✖</a> <a id="1713" class="Keyword">rewrite</a> <a id="1721" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="1725" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1727" href="Protocol.Streamlet.Global.Step.html#5246" class="Function">lookup✖′</a> <a id="1736" href="Protocol.Streamlet.Invariants.Unforgeability.html#1609" class="Bound">p≢</a> <a id="1739" class="Symbol">=</a> <a id="1741" class="Bound">m∈</a>
  <a id="1746" href="Protocol.Streamlet.Invariants.Unforgeability.html#1557" class="Function">QED</a> <a id="1750" class="Symbol">|</a> <a id="1752" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1756" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1761" class="Keyword">rewrite</a> <a id="1769" href="Protocol.Streamlet.Global.Step.html#5141" class="Function">lookup✓′</a> <a id="1778" class="Symbol">=</a>
   <a id="1783" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="1788" href="Protocol.Streamlet.Invariants.Unforgeability.html#1501" class="Bound">ls→</a> <a id="1792" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="1795" class="Symbol">λ</a> <a id="1797" class="Keyword">where</a>
    <a id="1807" class="Symbol">(</a><a id="1808" href="Protocol.Streamlet.Local.Step.html#1314" class="InductiveConstructor">ProposeBlock</a> <a id="1821" class="Symbol">_</a> <a id="1823" class="Symbol">_</a> <a id="1825" class="Symbol">_</a> <a id="1827" class="Symbol">_)</a> <a id="1830" class="Symbol">→</a>
        <a id="1840" class="Keyword">let</a>
          <a id="1854" href="Protocol.Streamlet.Invariants.Unforgeability.html#1854" class="Bound">m∈db</a> <a id="1859" class="Symbol">:</a>  <a id="1862" class="Bound">m</a> <a id="1864" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="1866" class="Symbol">(</a><a id="1867" class="Bound">s</a> <a id="1869" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="1871" class="Bound">p</a><a id="1872" class="Symbol">)</a> <a id="1874" class="Symbol">.</a><a id="1875" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a>
          <a id="1888" href="Protocol.Streamlet.Invariants.Unforgeability.html#1854" class="Bound">m∈db</a> <a id="1893" class="Symbol">=</a> <a id="1895" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="1898" class="Symbol">(</a><a id="1899" href="Protocol.Streamlet.Invariants.Unforgeability.html#2249" class="Function">m∈inbox✓</a> <a id="1908" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1912" class="Symbol">)</a> <a id="1914" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
        <a id="1927" class="Keyword">in</a> <a id="1930" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="1936" href="Protocol.Streamlet.Invariants.Unforgeability.html#1854" class="Bound">m∈db</a>
    <a id="1945" class="Symbol">(</a><a id="1946" href="Protocol.Streamlet.Local.Step.html#1710" class="InductiveConstructor">VoteBlock</a> <a id="1956" href="Protocol.Streamlet.Invariants.Unforgeability.html#1956" class="Bound">m∈</a> <a id="1959" class="Symbol">_</a> <a id="1961" class="Symbol">_</a> <a id="1963" class="Symbol">_</a> <a id="1965" class="Symbol">_</a> <a id="1967" class="Symbol">_)</a> <a id="1970" class="Symbol">→</a>
      <a id="1978" class="Keyword">let</a> <a id="1982" href="Protocol.Streamlet.Invariants.Unforgeability.html#1982" class="Bound">m∈inbox</a> <a id="1990" class="Symbol">=</a> <a id="1992" href="Prelude.Lists.html#6314" class="Function">∈-─⁻</a> <a id="1997" class="Symbol">(</a><a id="1998" href="Prelude.Irrelevance.html#1735" class="Function">AnyFirst⇒Any</a> <a id="2011" href="Protocol.Streamlet.Invariants.Unforgeability.html#1956" class="Bound">m∈</a><a id="2013" class="Symbol">)</a> <a id="2015" class="Symbol">(</a><a id="2016" href="Protocol.Streamlet.Invariants.Unforgeability.html#2249" class="Function">m∈inbox✓</a> <a id="2025" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2029" class="Symbol">)</a>
      <a id="2037" class="Keyword">in</a> <a id="2040" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="2046" href="Function.Base.html#3839" class="Function Operator">$′</a> <a id="2049" class="InductiveConstructor">there</a> <a id="2055" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2057" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="2060" href="Protocol.Streamlet.Invariants.Unforgeability.html#1982" class="Bound">m∈inbox</a> <a id="2068" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="2077" class="Symbol">(</a><a id="2078" href="Protocol.Streamlet.Local.Step.html#2361" class="InductiveConstructor">RegisterVote</a> <a id="2091" href="Protocol.Streamlet.Invariants.Unforgeability.html#2091" class="Bound">m∈</a> <a id="2094" class="Symbol">_)</a> <a id="2097" class="Symbol">→</a>
      <a id="2105" class="Keyword">let</a> <a id="2109" href="Protocol.Streamlet.Invariants.Unforgeability.html#2109" class="Bound">m∈inbox</a> <a id="2117" class="Symbol">=</a> <a id="2119" href="Prelude.Lists.html#6314" class="Function">∈-─⁻</a> <a id="2124" href="Protocol.Streamlet.Invariants.Unforgeability.html#2091" class="Bound">m∈</a> <a id="2127" class="Symbol">(</a><a id="2128" href="Protocol.Streamlet.Invariants.Unforgeability.html#2249" class="Function">m∈inbox✓</a> <a id="2137" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2141" class="Symbol">)</a>
      <a id="2149" class="Keyword">in</a> <a id="2152" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="2158" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2160" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="2163" href="Protocol.Streamlet.Invariants.Unforgeability.html#2109" class="Bound">m∈inbox</a> <a id="2171" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="2180" class="Symbol">(</a><a id="2181" href="Protocol.Streamlet.Local.Step.html#2751" class="InductiveConstructor">FinalizeBlock</a> <a id="2195" class="Symbol">_</a> <a id="2197" class="Symbol">_</a> <a id="2199" class="Symbol">_</a> <a id="2201" class="Symbol">_)</a> <a id="2204" class="Symbol">→</a>
      <a id="2212" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="2215" class="Symbol">(</a><a id="2216" href="Protocol.Streamlet.Invariants.Unforgeability.html#2249" class="Function">m∈inbox✓</a> <a id="2225" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2229" class="Symbol">)</a> <a id="2231" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
   <a id="2239" class="Keyword">where</a>
    <a id="2249" href="Protocol.Streamlet.Invariants.Unforgeability.html#2249" class="Function">m∈inbox✓</a> <a id="2258" class="Symbol">:</a> <a id="2260" class="Bound">p</a> <a id="2262" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2264" href="Protocol.Streamlet.Invariants.Unforgeability.html#1488" class="Bound">p′</a> <a id="2267" class="Symbol">→</a> <a id="2269" class="Bound">m</a> <a id="2271" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="2273" href="Protocol.Streamlet.Invariants.Unforgeability.html#1496" class="Bound">ls′</a> <a id="2277" class="Symbol">.</a><a id="2278" href="Protocol.Streamlet.Local.State.html#990" class="Field">inbox</a>
    <a id="2288" href="Protocol.Streamlet.Invariants.Unforgeability.html#2249" class="Function">m∈inbox✓</a> <a id="2297" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2302" class="Keyword">rewrite</a> <a id="2310" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="2314" href="Protocol.Streamlet.Global.Step.html#5141" class="Function">lookup✓′</a> <a id="2323" class="Symbol">=</a> <a id="2325" class="Bound">m∈</a>
<a id="2328" class="Symbol">...</a> <a id="2332" class="Symbol">|</a> <a id="2334" href="Protocol.Streamlet.Global.Step.html#2028" class="InductiveConstructor">DishonestLocalStep</a> <a id="2353" class="Symbol">_</a> <a id="2355" class="Symbol">_</a>
  <a id="2359" class="Symbol">=</a> <a id="2361" href="Protocol.Streamlet.Invariants.Unforgeability.html#833" class="Bound">IH</a> <a id="2364" class="Bound">m∈</a> <a id="2367" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
</pre>
</body>
</html>
