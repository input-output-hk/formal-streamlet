<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Protocol.Streamlet.Invariants.History</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="Agda.css" />
</head>
<body>
<h1 id="invariants-related-to-the-global-history.">Invariants related to
the global history.</h1>
<!--
<pre class="Agda"><a id="59" class="Symbol">{-#</a> <a id="63" class="Keyword">OPTIONS</a> <a id="71" class="Pragma">--safe</a> <a id="78" class="Symbol">#-}</a>
<a id="82" class="Keyword">open</a> <a id="87" class="Keyword">import</a> <a id="94" href="Prelude.html" class="Module">Prelude</a>
<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Hash.html" class="Module">Hash</a>

<a id="120" class="Keyword">open</a> <a id="125" class="Keyword">import</a> <a id="132" href="Protocol.Streamlet.Assumptions.html" class="Module">Protocol.Streamlet.Assumptions</a>

<a id="164" class="Keyword">module</a> <a id="171" href="Protocol.Streamlet.Invariants.History.html" class="Module">Protocol.Streamlet.Invariants.History</a> <a id="209" class="Symbol">(</a><a id="210" href="Protocol.Streamlet.Invariants.History.html#210" class="Bound">⋯</a> <a id="212" class="Symbol">:</a> <a id="214" class="Symbol">_)</a> <a id="217" class="Symbol">(</a><a id="218" class="Keyword">open</a> <a id="223" href="Protocol.Streamlet.Assumptions.html#222" class="Module">Assumptions</a> <a id="235" href="Protocol.Streamlet.Invariants.History.html#210" class="Bound">⋯</a><a id="236" class="Symbol">)</a> <a id="238" class="Keyword">where</a>

<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Protocol.Streamlet.html" class="Module">Protocol.Streamlet</a> <a id="276" href="Protocol.Streamlet.Invariants.History.html#210" class="Bound">⋯</a>
  <a id="280" class="Keyword">hiding</a> <a id="287" class="Symbol">(</a><a id="288" href="Protocol.Streamlet.Local.State.html#1086" class="Generalizable">ls′</a><a id="291" class="Symbol">)</a>
</pre>-->
<pre class="Agda"><a id="310" class="Comment">-- ** all messages in history are actually sent</a>
<a id="HistorySound"></a><a id="358" href="Protocol.Streamlet.Invariants.History.html#358" class="Function">HistorySound</a> <a id="371" class="Symbol">:</a> <a id="373" href="Protocol.Streamlet.Global.Traces.html#966" class="Function">StateProperty</a>
<a id="387" href="Protocol.Streamlet.Invariants.History.html#358" class="Function">HistorySound</a> <a id="400" href="Protocol.Streamlet.Invariants.History.html#400" class="Bound">s</a> <a id="402" class="Symbol">=</a> <a id="404" class="Symbol">∀</a> <a id="406" class="Symbol">{</a><a id="407" href="Protocol.Streamlet.Invariants.History.html#407" class="Bound">p</a> <a id="409" href="Protocol.Streamlet.Invariants.History.html#409" class="Bound">m</a><a id="410" class="Symbol">}</a> <a id="412" class="Symbol">⦃</a> <a id="414" href="Protocol.Streamlet.Invariants.History.html#414" class="Bound">_</a> <a id="416" class="Symbol">:</a> <a id="418" href="Protocol.Streamlet.Assumptions.html#1062" class="Field">Honest</a> <a id="425" href="Protocol.Streamlet.Invariants.History.html#407" class="Bound">p</a> <a id="427" class="Symbol">⦄</a> <a id="429" class="Symbol">→</a>
  <a id="433" href="Prelude.InferenceRules.html#56097" class="Function Operator">∙</a> <a id="435" href="Protocol.Streamlet.Invariants.History.html#409" class="Bound">m</a> <a id="437" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="439" href="Protocol.Streamlet.Invariants.History.html#400" class="Bound">s</a> <a id="441" class="Symbol">.</a><a id="442" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>
  <a id="452" href="Prelude.InferenceRules.html#56028" class="Function Operator">∙</a> <a id="454" href="Protocol.Streamlet.Invariants.History.html#407" class="Bound">p</a> <a id="456" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="458" href="Protocol.Streamlet.Invariants.History.html#409" class="Bound">m</a> <a id="460" href="Protocol.Streamlet.Block.html#2305" class="Field Operator">∙pid</a>
    <a id="469" href="Prelude.InferenceRules.html#14209" class="Function Operator">───────────────</a>
    <a id="489" href="Protocol.Streamlet.Invariants.History.html#409" class="Bound">m</a> <a id="491" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="493" class="Symbol">(</a><a id="494" href="Protocol.Streamlet.Invariants.History.html#400" class="Bound">s</a> <a id="496" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="498" href="Protocol.Streamlet.Invariants.History.html#407" class="Bound">p</a><a id="499" class="Symbol">)</a> <a id="501" class="Symbol">.</a><a id="502" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a>

<a id="historySound"></a><a id="506" href="Protocol.Streamlet.Invariants.History.html#506" class="Function">historySound</a> <a id="519" class="Symbol">:</a> <a id="521" href="Prelude.Closures.html#3717" class="Function">Invariant</a> <a id="531" href="Protocol.Streamlet.Invariants.History.html#358" class="Function">HistorySound</a>
<a id="544" href="Protocol.Streamlet.Invariants.History.html#506" class="Function">historySound</a> <a id="557" class="Symbol">=</a> <a id="559" href="Prelude.Closures.html#3892" class="Function">Step⇒Invariant</a> <a id="574" class="Symbol">(λ</a> <a id="577" class="Keyword">where</a> <a id="583" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="588" class="Symbol">())</a> <a id="592" href="Protocol.Streamlet.Invariants.History.html#616" class="Function">historySound→</a>
  <a id="608" class="Keyword">where</a>
  <a id="616" href="Protocol.Streamlet.Invariants.History.html#616" class="Function">historySound→</a> <a id="630" class="Symbol">:</a> <a id="632" href="Prelude.Closures.html#3184" class="Function">StepPreserved</a> <a id="646" href="Protocol.Streamlet.Invariants.History.html#358" class="Function">HistorySound</a>
  <a id="661" href="Protocol.Streamlet.Invariants.History.html#616" class="Function">historySound→</a> <a id="675" class="Symbol">{</a><a id="676" href="Protocol.Streamlet.Invariants.History.html#676" class="Bound">s</a><a id="677" class="Symbol">}{</a><a id="679" href="Protocol.Streamlet.Invariants.History.html#679" class="Bound">s′</a><a id="681" class="Symbol">}</a> <a id="683" href="Protocol.Streamlet.Invariants.History.html#683" class="Bound">s→</a>
    <a id="690" href="Protocol.Streamlet.Invariants.History.html#690" class="Bound">IH₀</a> <a id="694" class="Symbol">{</a><a id="695" href="Protocol.Streamlet.Invariants.History.html#695" class="Bound">p</a><a id="696" class="Symbol">}{</a><a id="698" href="Protocol.Streamlet.Invariants.History.html#698" class="Bound">m</a><a id="699" class="Symbol">}</a> <a id="701" class="Symbol">⦃</a> <a id="703" href="Protocol.Streamlet.Invariants.History.html#703" class="Bound">hp</a> <a id="706" class="Symbol">⦄</a> <a id="708" href="Protocol.Streamlet.Invariants.History.html#708" class="Bound">m∈</a> <a id="711" href="Protocol.Streamlet.Invariants.History.html#711" class="Bound">p≡</a>
    <a id="718" class="Keyword">with</a> <a id="723" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> ← <a id="728" class="Symbol">(λ</a> <a id="731" class="Symbol">(</a><a id="732" href="Protocol.Streamlet.Invariants.History.html#732" class="Bound">m∈</a> <a id="735" class="Symbol">:</a> <a id="737" href="Protocol.Streamlet.Invariants.History.html#698" class="Bound">m</a> <a id="739" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="741" href="Protocol.Streamlet.Invariants.History.html#676" class="Bound">s</a> <a id="743" class="Symbol">.</a><a id="744" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a><a id="751" class="Symbol">)</a> <a id="753" class="Symbol">→</a> <a id="755" href="Protocol.Streamlet.Invariants.History.html#690" class="Bound">IH₀</a> <a id="759" href="Protocol.Streamlet.Invariants.History.html#732" class="Bound">m∈</a> <a id="762" href="Protocol.Streamlet.Invariants.History.html#711" class="Bound">p≡</a><a id="764" class="Symbol">)</a>
    <a id="770" class="Keyword">with</a> <a id="775" href="Protocol.Streamlet.Invariants.History.html#683" class="Bound">s→</a>
  <a id="780" class="Symbol">...</a> <a id="784" class="Symbol">|</a> <a id="786" href="Protocol.Streamlet.Global.Step.html#2366" class="InductiveConstructor">Deliver</a> <a id="794" class="Symbol">{</a><a id="795" class="Argument">env</a> <a id="799" class="Symbol">=</a> <a id="801" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">[</a> <a id="803" href="Protocol.Streamlet.Invariants.History.html#803" class="Bound">p′</a> <a id="806" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">∣</a> <a id="808" href="Protocol.Streamlet.Invariants.History.html#808" class="Bound">m′</a> <a id="811" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">⟩</a><a id="812" class="Symbol">}</a> <a id="814" href="Protocol.Streamlet.Invariants.History.html#814" class="Bound">env∈</a>
    <a id="823" class="Keyword">rewrite</a> <a id="831" class="Keyword">let</a> <a id="835" class="Keyword">open</a> <a id="840" href="Protocol.Streamlet.Global.Step.html#3985" class="Module">∣Deliver∣</a> <a id="850" class="Bound">p</a> <a id="852" class="Bound">s</a> <a id="854" href="Protocol.Streamlet.Invariants.History.html#814" class="Bound">env∈</a> <a id="859" class="Keyword">in</a> <a id="862" href="Protocol.Streamlet.Global.Step.html#4348" class="Function">db≡</a>
    <a id="870" class="Symbol">=</a> <a id="872" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> <a id="875" class="Bound">m∈</a>
  <a id="880" class="Symbol">...</a> <a id="884" class="Symbol">|</a> <a id="886" href="Protocol.Streamlet.Global.Step.html#2518" class="InductiveConstructor">AdvanceEpoch</a>
    <a id="903" class="Keyword">rewrite</a> <a id="911" class="Keyword">let</a> <a id="915" class="Keyword">open</a> <a id="920" href="Protocol.Streamlet.Global.Step.html#3883" class="Module">∣AdvanceEpoch∣</a> <a id="935" class="Bound">p</a> <a id="937" class="Bound">s</a> <a id="939" class="Keyword">in</a> <a id="942" href="Protocol.Streamlet.Global.Step.html#3927" class="Function">lookup✓</a>
    <a id="954" class="Symbol">=</a> <a id="956" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> <a id="959" class="Bound">m∈</a>
  <a id="964" class="Symbol">...</a> <a id="968" class="Symbol">|</a> <a id="970" href="Protocol.Streamlet.Global.Step.html#2625" class="InductiveConstructor">Drop</a> <a id="975" class="Symbol">_</a>
    <a id="981" class="Symbol">=</a> <a id="983" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> <a id="986" class="Bound">m∈</a>
  <a id="991" class="Symbol">...</a> <a id="995" class="Symbol">|</a> <a id="997" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="1007" class="Symbol">{</a><a id="1008" class="Argument">p</a> <a id="1010" class="Symbol">=</a> <a id="1012" href="Protocol.Streamlet.Invariants.History.html#1012" class="Bound">p′</a><a id="1014" class="Symbol">}{</a><a id="1016" href="Protocol.Streamlet.Invariants.History.html#1016" class="Bound">mm</a><a id="1018" class="Symbol">}{</a><a id="1020" href="Protocol.Streamlet.Invariants.History.html#1020" class="Bound">ls′</a><a id="1023" class="Symbol">}</a> <a id="1025" href="Protocol.Streamlet.Invariants.History.html#1025" class="Bound">ls→</a>
    <a id="1033" class="Symbol">=</a> <a id="1035" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">QED</a>
    <a id="1043" class="Keyword">where</a>
    <a id="1053" class="Keyword">open</a> <a id="1058" href="Protocol.Streamlet.Global.Step.html#4791" class="Module">∣LocalStep∣</a> <a id="1070" class="Bound">p</a> <a id="1072" href="Protocol.Streamlet.Invariants.History.html#1012" class="Bound">p′</a> <a id="1075" class="Bound">s</a> <a id="1077" href="Protocol.Streamlet.Invariants.History.html#1016" class="Bound">mm</a> <a id="1080" href="Protocol.Streamlet.Invariants.History.html#1020" class="Bound">ls′</a>

    <a id="1089" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">QED</a> <a id="1093" class="Symbol">:</a> <a id="1095" class="Bound">m</a> <a id="1097" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="1099" class="Symbol">(</a><a id="1100" class="Bound">s′</a> <a id="1103" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="1105" class="Bound">p</a><a id="1106" class="Symbol">)</a> <a id="1108" class="Symbol">.</a><a id="1109" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a>
    <a id="1116" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">QED</a>
      <a id="1126" class="Keyword">with</a> <a id="1131" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1133" href="Protocol.Streamlet.Invariants.History.html#1025" class="Bound">ls→</a>
    <a id="1141" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">QED</a> <a id="1145" class="Symbol">|</a> <a id="1147" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1149" href="Protocol.Streamlet.Local.Step.html#1314" class="InductiveConstructor">ProposeBlock</a> <a id="1162" class="Symbol">{</a><a id="1163" class="Argument">ch</a> <a id="1166" class="Symbol">=</a> <a id="1168" href="Protocol.Streamlet.Invariants.History.html#1168" class="Bound">ch</a><a id="1170" class="Symbol">}</a> <a id="1172" class="Symbol">{</a><a id="1173" class="Argument">txs</a> <a id="1177" class="Symbol">=</a> <a id="1179" href="Protocol.Streamlet.Invariants.History.html#1179" class="Bound">txs</a><a id="1182" class="Symbol">}</a> <a id="1184" class="Symbol">_</a> <a id="1186" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1191" class="Symbol">_</a> <a id="1193" class="Symbol">_</a>
      <a id="1201" class="Keyword">with</a> <a id="1206" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1208" class="Bound">m∈</a>
    <a id="1215" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">...</a> <a id="1219" class="Symbol">|</a> <a id="1221" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1223" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="1228" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1233" class="Keyword">rewrite</a> <a id="1241" class="Bound">p≡</a> <a id="1244" class="Symbol">|</a> <a id="1246" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a> <a id="1254" class="Symbol">=</a> <a id="1256" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="1261" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1270" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">...</a> <a id="1274" class="Symbol">|</a> <a id="1276" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1278" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="1284" href="Protocol.Streamlet.Invariants.History.html#1284" class="Bound">m∈</a>
      <a id="1293" class="Keyword">with</a> <a id="1298" href="Protocol.Streamlet.Invariants.History.html#1298" class="Bound">ih</a> ← <a id="1303" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> <a id="1306" href="Protocol.Streamlet.Invariants.History.html#1284" class="Bound">m∈</a>
      <a id="1315" class="Keyword">with</a> <a id="1320" class="Bound">p</a> <a id="1322" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1324" href="Protocol.Streamlet.Invariants.History.html#1012" class="Bound">p′</a>
    <a id="1331" class="Symbol">...</a> <a id="1335" class="Symbol">|</a> <a id="1337" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1341" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1346" class="Keyword">rewrite</a> <a id="1354" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a> <a id="1362" class="Symbol">=</a> <a id="1364" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="1370" href="Protocol.Streamlet.Invariants.History.html#1298" class="Bound">ih</a>
    <a id="1377" class="Symbol">...</a> <a id="1381" class="Symbol">|</a> <a id="1383" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="1387" href="Protocol.Streamlet.Invariants.History.html#1387" class="Bound">p≢</a>   <a id="1392" class="Keyword">rewrite</a> <a id="1400" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="1408" href="Protocol.Streamlet.Invariants.History.html#1387" class="Bound">p≢</a> <a id="1411" class="Symbol">=</a> <a id="1413" href="Protocol.Streamlet.Invariants.History.html#1298" class="Bound">ih</a>
    <a id="1420" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">QED</a> <a id="1424" class="Symbol">|</a> <a id="1426" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1428" href="Protocol.Streamlet.Local.Step.html#1710" class="InductiveConstructor">VoteBlock</a> <a id="1438" class="Symbol">{</a><a id="1439" class="Argument">txs</a> <a id="1443" class="Symbol">=</a> <a id="1445" href="Protocol.Streamlet.Invariants.History.html#1445" class="Bound">txs</a><a id="1448" class="Symbol">}</a> <a id="1450" href="Protocol.Streamlet.Invariants.History.html#1450" class="Bound">M∈</a> <a id="1453" class="Symbol">_</a> <a id="1455" class="Symbol">_</a> <a id="1457" class="Symbol">_</a> <a id="1459" class="Symbol">_</a> <a id="1461" class="Symbol">_</a>
      <a id="1469" class="Keyword">with</a> <a id="1474" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1476" class="Bound">m∈</a>
    <a id="1483" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">...</a> <a id="1487" class="Symbol">|</a> <a id="1489" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1491" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="1496" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1501" class="Keyword">rewrite</a> <a id="1509" class="Bound">p≡</a> <a id="1512" class="Symbol">|</a> <a id="1514" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a> <a id="1522" class="Symbol">=</a> <a id="1524" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="1529" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1538" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">...</a> <a id="1542" class="Symbol">|</a> <a id="1544" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1546" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="1552" href="Protocol.Streamlet.Invariants.History.html#1552" class="Bound">m∈</a>
      <a id="1561" class="Keyword">with</a> <a id="1566" href="Protocol.Streamlet.Invariants.History.html#1566" class="Bound">ih</a> ← <a id="1571" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> <a id="1574" href="Protocol.Streamlet.Invariants.History.html#1552" class="Bound">m∈</a>
      <a id="1583" class="Keyword">with</a> <a id="1588" class="Bound">p</a> <a id="1590" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1592" href="Protocol.Streamlet.Invariants.History.html#1012" class="Bound">p′</a>
    <a id="1599" class="Symbol">...</a> <a id="1603" class="Symbol">|</a> <a id="1605" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1609" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1614" class="Keyword">rewrite</a> <a id="1622" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a> <a id="1630" class="Symbol">=</a> <a id="1632" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="1638" href="Function.Base.html#3839" class="Function Operator">$′</a> <a id="1641" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="1647" href="Protocol.Streamlet.Invariants.History.html#1566" class="Bound">ih</a>
    <a id="1654" class="Symbol">...</a> <a id="1658" class="Symbol">|</a> <a id="1660" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="1664" href="Protocol.Streamlet.Invariants.History.html#1664" class="Bound">p≢</a>   <a id="1669" class="Keyword">rewrite</a> <a id="1677" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="1685" href="Protocol.Streamlet.Invariants.History.html#1664" class="Bound">p≢</a> <a id="1688" class="Symbol">=</a> <a id="1690" href="Protocol.Streamlet.Invariants.History.html#1566" class="Bound">ih</a>
    <a id="1697" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">QED</a> <a id="1701" class="Symbol">|</a> <a id="1703" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1705" href="Protocol.Streamlet.Local.Step.html#2361" class="InductiveConstructor">RegisterVote</a> <a id="1718" class="Symbol">{</a><a id="1719" class="Argument">sb</a> <a id="1722" class="Symbol">=</a> <a id="1724" href="Protocol.Streamlet.Invariants.History.html#1724" class="Bound">sb</a><a id="1726" class="Symbol">}</a> <a id="1728" href="Protocol.Streamlet.Invariants.History.html#1728" class="Bound">M∈</a> <a id="1731" href="Protocol.Streamlet.Invariants.History.html#1731" class="Bound">M∉</a>
      <a id="1740" class="Keyword">with</a> <a id="1745" href="Protocol.Streamlet.Invariants.History.html#1745" class="Bound">ih</a> ← <a id="1750" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> <a id="1753" class="Bound">m∈</a>
      <a id="1762" class="Keyword">with</a> <a id="1767" class="Bound">p</a> <a id="1769" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1771" href="Protocol.Streamlet.Invariants.History.html#1012" class="Bound">p′</a>
    <a id="1778" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">...</a> <a id="1782" class="Symbol">|</a> <a id="1784" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1788" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1793" class="Keyword">rewrite</a> <a id="1801" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a> <a id="1809" class="Symbol">=</a> <a id="1811" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="1817" href="Protocol.Streamlet.Invariants.History.html#1745" class="Bound">ih</a>
    <a id="1824" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">...</a> <a id="1828" class="Symbol">|</a> <a id="1830" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="1834" href="Protocol.Streamlet.Invariants.History.html#1834" class="Bound">p≢</a>   <a id="1839" class="Keyword">rewrite</a> <a id="1847" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="1855" href="Protocol.Streamlet.Invariants.History.html#1834" class="Bound">p≢</a> <a id="1858" class="Symbol">=</a> <a id="1860" href="Protocol.Streamlet.Invariants.History.html#1745" class="Bound">ih</a>
    <a id="1867" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">QED</a> <a id="1871" class="Symbol">|</a> <a id="1873" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="1875" href="Protocol.Streamlet.Local.Step.html#2751" class="InductiveConstructor">FinalizeBlock</a> <a id="1889" href="Protocol.Streamlet.Invariants.History.html#1889" class="Bound">ch</a> <a id="1892" class="Symbol">_</a> <a id="1894" class="Symbol">_</a> <a id="1896" class="Symbol">_</a>
      <a id="1904" class="Keyword">with</a> <a id="1909" href="Protocol.Streamlet.Invariants.History.html#1909" class="Bound">ih</a> ← <a id="1914" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> <a id="1917" class="Bound">m∈</a>
      <a id="1926" class="Keyword">with</a> <a id="1931" class="Bound">p</a> <a id="1933" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="1935" href="Protocol.Streamlet.Invariants.History.html#1012" class="Bound">p′</a>
    <a id="1942" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">...</a> <a id="1946" class="Symbol">|</a> <a id="1948" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="1952" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1957" class="Keyword">rewrite</a> <a id="1965" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a> <a id="1973" class="Symbol">=</a> <a id="1975" href="Protocol.Streamlet.Invariants.History.html#1909" class="Bound">ih</a>
    <a id="1982" href="Protocol.Streamlet.Invariants.History.html#1089" class="Function">...</a> <a id="1986" class="Symbol">|</a> <a id="1988" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="1991" href="Protocol.Streamlet.Invariants.History.html#1991" class="Bound">p≢</a> <a id="1994" class="Keyword">rewrite</a> <a id="2002" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="2010" href="Protocol.Streamlet.Invariants.History.html#1991" class="Bound">p≢</a> <a id="2013" class="Symbol">=</a> <a id="2015" href="Protocol.Streamlet.Invariants.History.html#1909" class="Bound">ih</a>
  <a id="2020" class="Symbol">...</a> <a id="2024" class="Symbol">|</a> <a id="2026" href="Protocol.Streamlet.Global.Step.html#2028" class="InductiveConstructor">DishonestLocalStep</a> <a id="2045" href="Protocol.Streamlet.Invariants.History.html#2045" class="Bound">¬hp′</a> <a id="2050" href="Protocol.Streamlet.Invariants.History.html#2050" class="Bound">h⇒m∈</a>
    <a id="2059" class="Symbol">=</a> <a id="2061" href="Protocol.Streamlet.Invariants.History.html#2200" class="Function">QED</a>
    <a id="2069" class="Keyword">where</a>
    <a id="2079" href="Protocol.Streamlet.Invariants.History.html#2079" class="Function">≪m∈</a> <a id="2083" class="Symbol">:</a> <a id="2085" class="Bound">m</a> <a id="2087" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="2089" class="Bound">s</a> <a id="2091" class="Symbol">.</a><a id="2092" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>
    <a id="2104" href="Protocol.Streamlet.Invariants.History.html#2079" class="Function">≪m∈</a> <a id="2108" class="Keyword">with</a> <a id="2113" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="2115" class="Bound">m∈</a>
    <a id="2122" href="Protocol.Streamlet.Invariants.History.html#2079" class="Function">...</a> <a id="2126" class="Symbol">|</a> <a id="2128" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="2130" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="2135" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2140" class="Symbol">=</a> <a id="2142" href="Protocol.Streamlet.Invariants.History.html#2050" class="Bound">h⇒m∈</a> <a id="2147" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2149" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a> <a id="2155" href="Protocol.Streamlet.Assumptions.html#1062" class="Field">Honest</a> <a id="2162" class="Bound">p≡</a> <a id="2165" href="Function.Base.html#4736" class="Function">it</a>
    <a id="2172" href="Protocol.Streamlet.Invariants.History.html#2079" class="Function">...</a> <a id="2176" class="Symbol">|</a> <a id="2178" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="2180" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="2186" href="Protocol.Streamlet.Invariants.History.html#2186" class="Bound">m∈</a>  <a id="2190" class="Symbol">=</a> <a id="2192" href="Protocol.Streamlet.Invariants.History.html#2186" class="Bound">m∈</a>

    <a id="2200" href="Protocol.Streamlet.Invariants.History.html#2200" class="Function">QED</a> <a id="2204" class="Symbol">:</a> <a id="2206" class="Bound">m</a> <a id="2208" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="2210" class="Symbol">(</a><a id="2211" class="Bound">s′</a> <a id="2214" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="2216" class="Bound">p</a><a id="2217" class="Symbol">)</a> <a id="2219" class="Symbol">.</a><a id="2220" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a>
    <a id="2227" href="Protocol.Streamlet.Invariants.History.html#2200" class="Function">QED</a> <a id="2231" class="Symbol">=</a> <a id="2233" href="Protocol.Streamlet.Invariants.History.html#723" class="Bound">IH</a> <a id="2236" href="Protocol.Streamlet.Invariants.History.html#2079" class="Function">≪m∈</a>

<a id="2241" class="Comment">-- ** all messages sent on the network are recorded in history</a>
<a id="NetworkComplete"></a><a id="2304" href="Protocol.Streamlet.Invariants.History.html#2304" class="Function">NetworkComplete</a> <a id="2320" class="Symbol">:</a> <a id="2322" href="Protocol.Streamlet.Global.Traces.html#966" class="Function">StateProperty</a>
<a id="2336" href="Protocol.Streamlet.Invariants.History.html#2304" class="Function">NetworkComplete</a> <a id="2352" href="Protocol.Streamlet.Invariants.History.html#2352" class="Bound">s</a> <a id="2354" class="Symbol">=</a> <a id="2356" class="Symbol">∀</a> <a id="2358" class="Symbol">{</a><a id="2359" href="Protocol.Streamlet.Invariants.History.html#2359" class="Bound">p</a> <a id="2361" href="Protocol.Streamlet.Invariants.History.html#2361" class="Bound">m</a><a id="2362" class="Symbol">}</a> <a id="2364" class="Symbol">→</a>
  <a id="2368" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">[</a> <a id="2370" href="Protocol.Streamlet.Invariants.History.html#2359" class="Bound">p</a> <a id="2372" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">∣</a> <a id="2374" href="Protocol.Streamlet.Invariants.History.html#2361" class="Bound">m</a> <a id="2376" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">⟩</a> <a id="2378" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="2380" href="Protocol.Streamlet.Invariants.History.html#2352" class="Bound">s</a> <a id="2382" class="Symbol">.</a><a id="2383" href="Protocol.Streamlet.Global.State.html#865" class="Field">networkBuffer</a>
  <a id="2399" href="Prelude.InferenceRules.html#13858" class="Function Operator">────────────────────────────</a>
  <a id="2430" href="Protocol.Streamlet.Invariants.History.html#2361" class="Bound">m</a> <a id="2432" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="2434" href="Protocol.Streamlet.Invariants.History.html#2352" class="Bound">s</a> <a id="2436" class="Symbol">.</a><a id="2437" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>

<a id="networkComplete"></a><a id="2446" href="Protocol.Streamlet.Invariants.History.html#2446" class="Function">networkComplete</a> <a id="2462" class="Symbol">:</a> <a id="2464" href="Prelude.Closures.html#3717" class="Function">Invariant</a> <a id="2474" href="Protocol.Streamlet.Invariants.History.html#2304" class="Function">NetworkComplete</a>
<a id="2490" href="Protocol.Streamlet.Invariants.History.html#2446" class="Function">networkComplete</a> <a id="2506" class="Symbol">=</a> <a id="2508" href="Prelude.Closures.html#3892" class="Function">Step⇒Invariant</a> <a id="2523" class="Symbol">(λ</a> <a id="2526" class="Keyword">where</a> <a id="2532" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2537" class="Symbol">())</a> <a id="2541" href="Protocol.Streamlet.Invariants.History.html#3022" class="Function">networkComplete→</a>
  <a id="2560" class="Keyword">where</a>
  <a id="2568" href="Protocol.Streamlet.Invariants.History.html#2568" class="Function">networkComplete-broadcast</a> <a id="2594" class="Symbol">:</a> <a id="2596" class="Symbol">∀</a> <a id="2598" href="Protocol.Streamlet.Invariants.History.html#2598" class="Bound">s</a> <a id="2600" href="Protocol.Streamlet.Invariants.History.html#2600" class="Bound">p</a> <a id="2602" href="Protocol.Streamlet.Invariants.History.html#2602" class="Bound">mm</a> <a id="2605" class="Symbol">→</a>
    <a id="2611" href="Protocol.Streamlet.Invariants.History.html#2304" class="Function">NetworkComplete</a> <a id="2627" href="Protocol.Streamlet.Invariants.History.html#2598" class="Bound">s</a>
    <a id="2633" href="Prelude.InferenceRules.html#13639" class="Function Operator">──────────────────────────────────</a>
    <a id="2672" href="Protocol.Streamlet.Invariants.History.html#2304" class="Function">NetworkComplete</a> <a id="2688" class="Symbol">(</a><a id="2689" href="Protocol.Streamlet.Global.Step.html#1107" class="Function">broadcast</a> <a id="2699" href="Protocol.Streamlet.Invariants.History.html#2600" class="Bound">p</a> <a id="2701" href="Protocol.Streamlet.Invariants.History.html#2602" class="Bound">mm</a> <a id="2704" href="Protocol.Streamlet.Invariants.History.html#2598" class="Bound">s</a><a id="2705" class="Symbol">)</a>
  <a id="2709" href="Protocol.Streamlet.Invariants.History.html#2568" class="Function">networkComplete-broadcast</a> <a id="2735" href="Protocol.Streamlet.Invariants.History.html#2735" class="Bound">s</a> <a id="2737" class="Symbol">_</a> <a id="2739" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>  <a id="2748" href="Protocol.Streamlet.Invariants.History.html#2748" class="Bound">IH</a> <a id="2751" class="Symbol">=</a> <a id="2753" href="Protocol.Streamlet.Invariants.History.html#2748" class="Bound">IH</a>
  <a id="2758" href="Protocol.Streamlet.Invariants.History.html#2568" class="Function">networkComplete-broadcast</a> <a id="2784" href="Protocol.Streamlet.Invariants.History.html#2784" class="Bound">s</a> <a id="2786" href="Protocol.Streamlet.Invariants.History.html#2786" class="Bound">p</a> <a id="2788" class="Symbol">(</a><a id="2789" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2794" href="Protocol.Streamlet.Invariants.History.html#2794" class="Bound">m</a><a id="2795" class="Symbol">)</a> <a id="2797" href="Protocol.Streamlet.Invariants.History.html#2797" class="Bound">IH</a> <a id="2800" href="Protocol.Streamlet.Invariants.History.html#2800" class="Bound">m∈</a>
    <a id="2807" class="Keyword">with</a> <a id="2812" href="Data.List.Membership.Propositional.Properties.html#4532" class="Function">L.Mem.∈-++⁻</a> <a id="2824" class="Symbol">(</a><a id="2825" href="Protocol.Streamlet.Invariants.History.html#2784" class="Bound">s</a> <a id="2827" class="Symbol">.</a><a id="2828" href="Protocol.Streamlet.Global.State.html#865" class="Field">networkBuffer</a><a id="2841" class="Symbol">)</a> <a id="2843" href="Protocol.Streamlet.Invariants.History.html#2800" class="Bound">m∈</a>
  <a id="2848" class="Symbol">...</a> <a id="2852" class="Symbol">|</a> <a id="2854" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2859" href="Protocol.Streamlet.Invariants.History.html#2859" class="Bound">m∈</a> <a id="2862" class="Symbol">=</a> <a id="2864" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="2870" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2872" class="Bound">IH</a> <a id="2875" href="Protocol.Streamlet.Invariants.History.html#2859" class="Bound">m∈</a>
  <a id="2880" class="Symbol">...</a> <a id="2884" class="Symbol">|</a> <a id="2886" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2891" href="Protocol.Streamlet.Invariants.History.html#2891" class="Bound">m∈</a>
    <a id="2898" class="Keyword">with</a> <a id="2903" class="Symbol">_</a> <a id="2905" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2907" href="Protocol.Streamlet.Invariants.History.html#2907" class="Bound">m∈</a> <a id="2910" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2912" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> ← <a id="2919" href="Data.List.Membership.Propositional.Properties.html#3880" class="Function">L.Mem.∈-map⁻</a> <a id="2932" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">[_∣</a> <a id="2936" class="Bound">m</a> <a id="2938" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">⟩</a> <a id="2940" href="Protocol.Streamlet.Invariants.History.html#2891" class="Bound">m∈</a>
    <a id="2947" class="Keyword">with</a> <a id="2952" href="Protocol.Streamlet.Invariants.History.html#2952" class="Bound">m∈</a> <a id="2955" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2957" class="Symbol">_</a> ← <a id="2961" href="Data.List.Membership.Propositional.Properties.html#9013" class="Function">L.Mem.∈-filter⁻</a> <a id="2977" class="Symbol">(</a><a id="2978" class="Bound">p</a> <a id="2980" href="Prelude.DecEq.html#335" class="Function Operator">≢?_</a><a id="2983" class="Symbol">)</a> <a id="2985" class="Symbol">{</a><a id="2986" class="Argument">xs</a> <a id="2989" class="Symbol">=</a> <a id="2991" href="Protocol.Streamlet.Assumptions.html#597" class="Function">allPids</a><a id="2998" class="Symbol">}</a> <a id="3000" href="Protocol.Streamlet.Invariants.History.html#2907" class="Bound">m∈</a>
    <a id="3007" class="Symbol">=</a> <a id="3009" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="3014" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

  <a id="3022" href="Protocol.Streamlet.Invariants.History.html#3022" class="Function">networkComplete→</a> <a id="3039" class="Symbol">:</a> <a id="3041" href="Prelude.Closures.html#3184" class="Function">StepPreserved</a> <a id="3055" href="Protocol.Streamlet.Invariants.History.html#2304" class="Function">NetworkComplete</a>
  <a id="3073" href="Protocol.Streamlet.Invariants.History.html#3022" class="Function">networkComplete→</a> <a id="3090" class="Symbol">{</a><a id="3091" href="Protocol.Streamlet.Invariants.History.html#3091" class="Bound">s</a><a id="3092" class="Symbol">}</a> <a id="3094" class="Symbol">=</a> <a id="3096" class="Keyword">let</a> <a id="3100" href="Protocol.Streamlet.Invariants.History.html#3100" class="Bound">H</a> <a id="3102" class="Symbol">=</a> <a id="3104" href="Protocol.Streamlet.Invariants.History.html#2568" class="Function">networkComplete-broadcast</a> <a id="3130" href="Protocol.Streamlet.Invariants.History.html#3091" class="Bound">s</a> <a id="3132" class="Keyword">in</a> <a id="3135" class="Symbol">λ</a> <a id="3137" class="Keyword">where</a>
    <a id="3147" class="Symbol">(</a><a id="3148" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="3158" class="Symbol">(</a><a id="3159" href="Protocol.Streamlet.Local.Step.html#1314" class="InductiveConstructor">ProposeBlock</a> <a id="3172" class="Symbol">_</a> <a id="3174" class="Symbol">_</a> <a id="3176" class="Symbol">_</a> <a id="3178" class="Symbol">_))</a>          <a id="3191" class="Symbol">→</a> <a id="3193" href="Protocol.Streamlet.Invariants.History.html#3100" class="Bound">H</a> <a id="3195" class="Symbol">_</a> <a id="3197" class="Symbol">(</a><a id="3198" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3203" class="Symbol">_)</a>
    <a id="3210" class="Symbol">(</a><a id="3211" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="3221" class="Symbol">(</a><a id="3222" href="Protocol.Streamlet.Local.Step.html#1710" class="InductiveConstructor">VoteBlock</a> <a id="3232" class="Symbol">_</a> <a id="3234" class="Symbol">_</a> <a id="3236" class="Symbol">_</a> <a id="3238" class="Symbol">_</a> <a id="3240" class="Symbol">_</a> <a id="3242" class="Symbol">_))</a>         <a id="3254" class="Symbol">→</a> <a id="3256" href="Protocol.Streamlet.Invariants.History.html#3100" class="Bound">H</a> <a id="3258" class="Symbol">_</a> <a id="3260" class="Symbol">(</a><a id="3261" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3266" class="Symbol">_)</a>
    <a id="3273" class="Symbol">(</a><a id="3274" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="3284" class="Symbol">{</a><a id="3285" class="Argument">p</a> <a id="3287" class="Symbol">=</a> <a id="3289" href="Protocol.Streamlet.Invariants.History.html#3289" class="Bound">p</a><a id="3290" class="Symbol">}</a> <a id="3292" class="Symbol">(</a><a id="3293" href="Protocol.Streamlet.Local.Step.html#2361" class="InductiveConstructor">RegisterVote</a> <a id="3306" class="Symbol">_</a> <a id="3308" class="Symbol">_))</a>      <a id="3317" class="Symbol">→</a> <a id="3319" href="Protocol.Streamlet.Invariants.History.html#3100" class="Bound">H</a> <a id="3321" href="Protocol.Streamlet.Invariants.History.html#3289" class="Bound">p</a> <a id="3323" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
    <a id="3335" class="Symbol">(</a><a id="3336" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="3346" class="Symbol">{</a><a id="3347" class="Argument">p</a> <a id="3349" class="Symbol">=</a> <a id="3351" href="Protocol.Streamlet.Invariants.History.html#3351" class="Bound">p</a><a id="3352" class="Symbol">}</a> <a id="3354" class="Symbol">(</a><a id="3355" href="Protocol.Streamlet.Local.Step.html#2751" class="InductiveConstructor">FinalizeBlock</a> <a id="3369" class="Symbol">_</a> <a id="3371" class="Symbol">_</a> <a id="3373" class="Symbol">_</a> <a id="3375" class="Symbol">_))</a> <a id="3379" class="Symbol">→</a> <a id="3381" href="Protocol.Streamlet.Invariants.History.html#3100" class="Bound">H</a> <a id="3383" href="Protocol.Streamlet.Invariants.History.html#3351" class="Bound">p</a> <a id="3385" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
    <a id="3397" class="Symbol">(</a><a id="3398" href="Protocol.Streamlet.Global.Step.html#2028" class="InductiveConstructor">DishonestLocalStep</a> <a id="3417" class="Symbol">{</a><a id="3418" class="Argument">m</a> <a id="3420" class="Symbol">=</a> <a id="3422" href="Protocol.Streamlet.Invariants.History.html#3422" class="Bound">m</a><a id="3423" class="Symbol">}</a> <a id="3425" class="Symbol">_</a> <a id="3427" class="Symbol">_)</a>            <a id="3441" class="Symbol">→</a> <a id="3443" href="Protocol.Streamlet.Invariants.History.html#2568" class="Function">networkComplete-broadcast</a> <a id="3469" href="Protocol.Streamlet.Invariants.History.html#3091" class="Bound">s</a> <a id="3471" class="Symbol">_</a> <a id="3473" class="Symbol">(</a><a id="3474" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3479" href="Protocol.Streamlet.Invariants.History.html#3422" class="Bound">m</a><a id="3480" class="Symbol">)</a>
    <a id="3486" class="Symbol">(</a><a id="3487" href="Protocol.Streamlet.Global.Step.html#2366" class="InductiveConstructor">Deliver</a> <a id="3495" class="Symbol">_)</a>  <a id="3499" class="Symbol">→</a> <a id="3501" href="Function.Base.html#1115" class="Function Operator">_∘</a> <a id="3504" href="Prelude.Lists.html#3782" class="Function">∈-removeAt⁻</a> <a id="3516" class="Symbol">_</a>
    <a id="3522" href="Protocol.Streamlet.Global.Step.html#2518" class="InductiveConstructor">AdvanceEpoch</a> <a id="3535" class="Symbol">→</a> <a id="3537" href="Function.Base.html#704" class="Function">id</a>
    <a id="3544" class="Symbol">(</a><a id="3545" href="Protocol.Streamlet.Global.Step.html#2625" class="InductiveConstructor">Drop</a> <a id="3550" class="Symbol">_)</a>     <a id="3557" class="Symbol">→</a> <a id="3559" href="Function.Base.html#1115" class="Function Operator">_∘</a> <a id="3562" href="Prelude.Lists.html#3782" class="Function">∈-removeAt⁻</a> <a id="3574" class="Symbol">_</a>

<a id="3577" class="Comment">-- ** honest participants′ inboxes are completely recorded in history</a>
<a id="InboxCompleteHonest"></a><a id="3647" href="Protocol.Streamlet.Invariants.History.html#3647" class="Function">InboxCompleteHonest</a> <a id="3667" class="Symbol">:</a> <a id="3669" href="Protocol.Streamlet.Global.Traces.html#966" class="Function">StateProperty</a>
<a id="3683" href="Protocol.Streamlet.Invariants.History.html#3647" class="Function">InboxCompleteHonest</a> <a id="3703" href="Protocol.Streamlet.Invariants.History.html#3703" class="Bound">s</a> <a id="3705" class="Symbol">=</a> <a id="3707" class="Symbol">∀</a> <a id="3709" class="Symbol">{</a><a id="3710" href="Protocol.Streamlet.Invariants.History.html#3710" class="Bound">p</a><a id="3711" class="Symbol">}</a> <a id="3713" class="Symbol">⦃</a> <a id="3715" href="Protocol.Streamlet.Invariants.History.html#3715" class="Bound">_</a> <a id="3717" class="Symbol">:</a> <a id="3719" href="Protocol.Streamlet.Assumptions.html#1062" class="Field">Honest</a> <a id="3726" href="Protocol.Streamlet.Invariants.History.html#3710" class="Bound">p</a> <a id="3728" class="Symbol">⦄</a> <a id="3730" class="Symbol">→</a>
  <a id="3734" href="Prelude.InferenceRules.html#45725" class="Function Operator">────────────────────────────</a>
  <a id="3765" class="Symbol">(</a><a id="3766" href="Protocol.Streamlet.Invariants.History.html#3703" class="Bound">s</a> <a id="3768" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="3770" href="Protocol.Streamlet.Invariants.History.html#3710" class="Bound">p</a><a id="3771" class="Symbol">)</a> <a id="3773" class="Symbol">.</a><a id="3774" href="Protocol.Streamlet.Local.State.html#990" class="Field">inbox</a> <a id="3780" href="Data.List.Relation.Binary.Subset.Setoid.html#825" class="Function Operator">⊆ˢ</a> <a id="3783" href="Protocol.Streamlet.Invariants.History.html#3703" class="Bound">s</a> <a id="3785" class="Symbol">.</a><a id="3786" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>

<a id="inboxCompleteHonest"></a><a id="3795" href="Protocol.Streamlet.Invariants.History.html#3795" class="Function">inboxCompleteHonest</a> <a id="3815" class="Symbol">:</a> <a id="3817" href="Prelude.Closures.html#3717" class="Function">Invariant</a> <a id="3827" href="Protocol.Streamlet.Invariants.History.html#3647" class="Function">InboxCompleteHonest</a>
<a id="3847" href="Protocol.Streamlet.Invariants.History.html#3795" class="Function">inboxCompleteHonest</a> <a id="3867" class="Symbol">(_</a> <a id="3870" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3872" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3877" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3879" class="Symbol">(_</a> <a id="3882" href="Prelude.Closures.html#689" class="InductiveConstructor Operator">∎</a><a id="3883" class="Symbol">))</a> <a id="3886" class="Symbol">{</a><a id="3887" href="Protocol.Streamlet.Invariants.History.html#3887" class="Bound">p</a><a id="3888" class="Symbol">}</a> <a id="3890" href="Protocol.Streamlet.Invariants.History.html#3890" class="Bound">m∈</a>
  <a id="3895" class="Keyword">rewrite</a> <a id="3903" class="Keyword">let</a> <a id="3907" class="Keyword">open</a> <a id="3912" href="Protocol.Streamlet.Global.Step.html#3796" class="Module">∣Base∣</a> <a id="3919" href="Protocol.Streamlet.Invariants.History.html#3887" class="Bound">p</a> <a id="3921" class="Keyword">in</a> <a id="3924" href="Protocol.Streamlet.Global.Step.html#3830" class="Function">lookup✓</a>
  <a id="3934" class="Symbol">=</a> <a id="3936" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="3941" href="Protocol.Streamlet.Invariants.History.html#3890" class="Bound">m∈</a> <a id="3944" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="3947" class="Symbol">λ</a> <a id="3949" class="Symbol">()</a>
<a id="3952" href="Protocol.Streamlet.Invariants.History.html#3795" class="Function">inboxCompleteHonest</a> <a id="3972" class="Symbol">{</a><a id="3973" href="Protocol.Streamlet.Invariants.History.html#3973" class="Bound">s′</a><a id="3975" class="Symbol">}</a> <a id="3977" class="Symbol">(_</a> <a id="3980" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3982" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3987" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3989" class="Symbol">(_</a> <a id="3992" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">⟨</a> <a id="3994" href="Protocol.Streamlet.Invariants.History.html#3994" class="Bound">s→</a> <a id="3997" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">∣</a> <a id="3999" href="Protocol.Streamlet.Invariants.History.html#3999" class="Bound">s</a> <a id="4001" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">⟩←—</a> <a id="4005" href="Protocol.Streamlet.Invariants.History.html#4005" class="Bound">tr</a><a id="4007" class="Symbol">))</a>
  <a id="4012" class="Symbol">{</a><a id="4013" href="Protocol.Streamlet.Invariants.History.html#4013" class="Bound">p</a><a id="4014" class="Symbol">}</a> <a id="4016" class="Symbol">{</a><a id="4017" href="Protocol.Streamlet.Invariants.History.html#4017" class="Bound">m</a><a id="4018" class="Symbol">}</a> <a id="4020" href="Protocol.Streamlet.Invariants.History.html#4020" class="Bound">m∈</a>
  <a id="4025" class="Keyword">with</a> <a id="4030" href="Protocol.Streamlet.Invariants.History.html#4030" class="Bound">Rs</a> ← <a id="4035" href="Data.Product.Base.html#1932" class="Function Operator">-,</a> <a id="4038" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4043" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4045" href="Protocol.Streamlet.Invariants.History.html#4005" class="Bound">tr</a>
  <a id="4050" class="Keyword">with</a> <a id="4055" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> ← <a id="4060" href="Protocol.Streamlet.Invariants.History.html#3795" class="Function">inboxCompleteHonest</a> <a id="4080" href="Protocol.Streamlet.Invariants.History.html#4030" class="Bound">Rs</a> <a id="4083" class="Symbol">⦃</a> <a id="4085" href="Function.Base.html#4736" class="Function">it</a> <a id="4088" class="Symbol">⦄</a>
  <a id="4092" class="Keyword">with</a> <a id="4097" href="Protocol.Streamlet.Invariants.History.html#3994" class="Bound">s→</a>
<a id="4100" class="Symbol">...</a> <a id="4104" class="Symbol">|</a> <a id="4106" href="Protocol.Streamlet.Global.Step.html#2366" class="InductiveConstructor">Deliver</a> <a id="4114" class="Symbol">{</a><a id="4115" class="Argument">env</a> <a id="4119" class="Symbol">=</a> <a id="4121" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">[</a> <a id="4123" href="Protocol.Streamlet.Invariants.History.html#4123" class="Bound">p′</a> <a id="4126" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">∣</a> <a id="4128" href="Protocol.Streamlet.Invariants.History.html#4128" class="Bound">m′</a> <a id="4131" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">⟩</a><a id="4132" class="Symbol">}</a> <a id="4134" href="Protocol.Streamlet.Invariants.History.html#4134" class="Bound">env∈</a>
  <a id="4141" class="Symbol">=</a> <a id="4143" href="Protocol.Streamlet.Invariants.History.html#4184" class="Function">QED</a>
  <a id="4149" class="Keyword">where</a>
  <a id="4157" class="Keyword">open</a> <a id="4162" href="Protocol.Streamlet.Global.Step.html#3985" class="Module">∣Deliver∣</a> <a id="4172" class="Bound">p</a> <a id="4174" class="Bound">s</a> <a id="4176" href="Protocol.Streamlet.Invariants.History.html#4134" class="Bound">env∈</a>

  <a id="4184" href="Protocol.Streamlet.Invariants.History.html#4184" class="Function">QED</a> <a id="4188" class="Symbol">:</a> <a id="4190" class="Bound">m</a> <a id="4192" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="4194" class="Bound">s′</a> <a id="4197" class="Symbol">.</a><a id="4198" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>
  <a id="4208" href="Protocol.Streamlet.Invariants.History.html#4184" class="Function">QED</a>
    <a id="4216" class="Keyword">with</a> <a id="4221" href="Protocol.Streamlet.Assumptions.html#1192" class="Function">honest?</a> <a id="4229" href="Protocol.Streamlet.Invariants.History.html#4123" class="Bound">p′</a>
  <a id="4234" href="Protocol.Streamlet.Invariants.History.html#4184" class="Function">...</a> <a id="4238" class="Symbol">|</a> <a id="4240" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="4243" class="Symbol">_</a> <a id="4245" class="Symbol">=</a> <a id="4247" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="4250" class="Bound">m∈</a>
  <a id="4255" href="Protocol.Streamlet.Invariants.History.html#4184" class="Function">...</a> <a id="4259" class="Symbol">|</a> <a id="4261" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="4265" href="Protocol.Streamlet.Invariants.History.html#4265" class="Bound">hp′</a>
    <a id="4273" class="Keyword">with</a> <a id="4278" class="Bound">p</a> <a id="4280" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="4282" href="Protocol.Streamlet.Invariants.History.html#4123" class="Bound">p′</a>
  <a id="4287" class="Symbol">...</a> <a id="4291" class="Symbol">|</a> <a id="4293" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="4296" href="Protocol.Streamlet.Invariants.History.html#4296" class="Bound">p≢</a> <a id="4299" class="Keyword">rewrite</a> <a id="4307" href="Protocol.Streamlet.Global.Step.html#4236" class="Function">lookup✖</a> <a id="4315" class="Symbol">⦃</a> <a id="4317" class="Bound">hp′</a> <a id="4321" class="Symbol">⦄</a> <a id="4323" href="Protocol.Streamlet.Invariants.History.html#4296" class="Bound">p≢</a> <a id="4326" class="Symbol">=</a> <a id="4328" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="4331" class="Bound">m∈</a>
  <a id="4336" class="Symbol">...</a> <a id="4340" class="Symbol">|</a> <a id="4342" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="4346" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4351" class="Keyword">rewrite</a> <a id="4359" href="Protocol.Streamlet.Global.Step.html#4169" class="Function">lookup✓</a> <a id="4367" class="Symbol">⦃</a> <a id="4369" href="Function.Base.html#4736" class="Function">it</a> <a id="4372" class="Symbol">⦄</a>
    <a id="4378" class="Keyword">with</a> <a id="4383" href="Prelude.Lists.html#4003" class="Function">∈-∷ʳ⁻</a> <a id="4389" class="Bound">m∈</a>
  <a id="4394" class="Symbol">...</a> <a id="4398" class="Symbol">|</a> <a id="4400" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="4405" href="Protocol.Streamlet.Invariants.History.html#4405" class="Bound">m∈</a>   <a id="4410" class="Symbol">=</a> <a id="4412" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="4415" href="Protocol.Streamlet.Invariants.History.html#4405" class="Bound">m∈</a>
  <a id="4420" class="Symbol">...</a> <a id="4424" class="Symbol">|</a> <a id="4426" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="4431" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4436" class="Symbol">=</a> <a id="4438" href="Protocol.Streamlet.Invariants.History.html#2446" class="Function">networkComplete</a> <a id="4454" href="Protocol.Streamlet.Invariants.History.html#4030" class="Bound">Rs</a> <a id="4457" href="Protocol.Streamlet.Invariants.History.html#4134" class="Bound">env∈</a>
<a id="4462" class="Symbol">...</a> <a id="4466" class="Symbol">|</a> <a id="4468" href="Protocol.Streamlet.Global.Step.html#2518" class="InductiveConstructor">AdvanceEpoch</a>
  <a id="4483" class="Keyword">rewrite</a> <a id="4491" class="Keyword">let</a> <a id="4495" class="Keyword">open</a> <a id="4500" href="Protocol.Streamlet.Global.Step.html#3883" class="Module">∣AdvanceEpoch∣</a> <a id="4515" class="Bound">p</a> <a id="4517" class="Bound">s</a> <a id="4519" class="Keyword">in</a> <a id="4522" href="Protocol.Streamlet.Global.Step.html#3927" class="Function">lookup✓</a>
  <a id="4532" class="Symbol">=</a> <a id="4534" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="4537" class="Bound">m∈</a>
<a id="4540" class="Symbol">...</a> <a id="4544" class="Symbol">|</a> <a id="4546" href="Protocol.Streamlet.Global.Step.html#2625" class="InductiveConstructor">Drop</a> <a id="4551" class="Symbol">_</a>
  <a id="4555" class="Symbol">=</a> <a id="4557" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="4560" class="Bound">m∈</a>
<a id="4563" class="Symbol">...</a> <a id="4567" class="Symbol">|</a> <a id="4569" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="4579" class="Symbol">{</a><a id="4580" class="Argument">p</a> <a id="4582" class="Symbol">=</a> <a id="4584" href="Protocol.Streamlet.Invariants.History.html#4584" class="Bound">p′</a><a id="4586" class="Symbol">}{</a><a id="4588" href="Protocol.Streamlet.Invariants.History.html#4588" class="Bound">mm</a><a id="4590" class="Symbol">}{</a><a id="4592" href="Protocol.Streamlet.Invariants.History.html#4592" class="Bound">ls′</a><a id="4595" class="Symbol">}</a> <a id="4597" href="Protocol.Streamlet.Invariants.History.html#4597" class="Bound">ls→</a>
  <a id="4603" class="Symbol">=</a> <a id="4605" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">QED</a>
  <a id="4611" class="Keyword">where</a>
  <a id="4619" class="Keyword">open</a> <a id="4624" href="Protocol.Streamlet.Global.Step.html#4791" class="Module">∣LocalStep∣</a> <a id="4636" class="Bound">p</a> <a id="4638" href="Protocol.Streamlet.Invariants.History.html#4584" class="Bound">p′</a> <a id="4641" class="Bound">s</a> <a id="4643" href="Protocol.Streamlet.Invariants.History.html#4588" class="Bound">mm</a> <a id="4646" href="Protocol.Streamlet.Invariants.History.html#4592" class="Bound">ls′</a>

  <a id="4653" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">QED</a> <a id="4657" class="Symbol">:</a> <a id="4659" class="Bound">m</a> <a id="4661" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="4663" class="Bound">s′</a> <a id="4666" class="Symbol">.</a><a id="4667" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>
  <a id="4677" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">QED</a>
    <a id="4685" class="Keyword">with</a> <a id="4690" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="4692" href="Protocol.Streamlet.Invariants.History.html#4597" class="Bound">ls→</a>
  <a id="4698" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">QED</a> <a id="4702" class="Symbol">|</a> <a id="4704" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="4706" href="Protocol.Streamlet.Local.Step.html#1314" class="InductiveConstructor">ProposeBlock</a> <a id="4719" class="Symbol">{</a><a id="4720" class="Argument">ch</a> <a id="4723" class="Symbol">=</a> <a id="4725" href="Protocol.Streamlet.Invariants.History.html#4725" class="Bound">ch</a><a id="4727" class="Symbol">}</a> <a id="4729" class="Symbol">{</a><a id="4730" class="Argument">txs</a> <a id="4734" class="Symbol">=</a> <a id="4736" href="Protocol.Streamlet.Invariants.History.html#4736" class="Bound">txs</a><a id="4739" class="Symbol">}</a> <a id="4741" class="Symbol">_</a> <a id="4743" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4748" class="Symbol">_</a> <a id="4750" class="Symbol">_</a>
    <a id="4756" class="Keyword">with</a> <a id="4761" class="Bound">p</a> <a id="4763" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="4765" href="Protocol.Streamlet.Invariants.History.html#4584" class="Bound">p′</a>
  <a id="4770" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">...</a> <a id="4774" class="Symbol">|</a> <a id="4776" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="4780" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4785" class="Keyword">rewrite</a> <a id="4793" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>    <a id="4804" class="Symbol">=</a> <a id="4806" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="4812" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4814" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="4817" class="Bound">m∈</a>
  <a id="4822" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">...</a> <a id="4826" class="Symbol">|</a> <a id="4828" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="4832" href="Protocol.Streamlet.Invariants.History.html#4832" class="Bound">p≢</a>   <a id="4837" class="Keyword">rewrite</a> <a id="4845" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="4853" href="Protocol.Streamlet.Invariants.History.html#4832" class="Bound">p≢</a> <a id="4856" class="Symbol">=</a> <a id="4858" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="4864" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4866" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="4869" class="Bound">m∈</a>
  <a id="4874" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">QED</a> <a id="4878" class="Symbol">|</a> <a id="4880" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="4882" href="Protocol.Streamlet.Local.Step.html#1710" class="InductiveConstructor">VoteBlock</a> <a id="4892" class="Symbol">{</a><a id="4893" class="Argument">txs</a> <a id="4897" class="Symbol">=</a> <a id="4899" href="Protocol.Streamlet.Invariants.History.html#4899" class="Bound">txs</a><a id="4902" class="Symbol">}</a> <a id="4904" href="Protocol.Streamlet.Invariants.History.html#4904" class="Bound">M∈</a> <a id="4907" class="Symbol">_</a> <a id="4909" class="Symbol">_</a> <a id="4911" class="Symbol">_</a> <a id="4913" class="Symbol">_</a> <a id="4915" class="Symbol">_</a>
    <a id="4921" class="Keyword">with</a> <a id="4926" class="Bound">p</a> <a id="4928" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="4930" href="Protocol.Streamlet.Invariants.History.html#4584" class="Bound">p′</a>
  <a id="4935" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">...</a> <a id="4939" class="Symbol">|</a> <a id="4941" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="4945" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4950" class="Keyword">rewrite</a> <a id="4958" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>    <a id="4969" class="Symbol">=</a> <a id="4971" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="4977" href="Function.Base.html#3839" class="Function Operator">$′</a> <a id="4980" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="4983" class="Symbol">(</a><a id="4984" href="Prelude.Lists.html#3782" class="Function">∈-removeAt⁻</a> <a id="4996" class="Symbol">_</a> <a id="4998" class="Bound">m∈</a><a id="5000" class="Symbol">)</a>
  <a id="5004" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">...</a> <a id="5008" class="Symbol">|</a> <a id="5010" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="5014" href="Protocol.Streamlet.Invariants.History.html#5014" class="Bound">p≢</a>   <a id="5019" class="Keyword">rewrite</a> <a id="5027" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="5035" href="Protocol.Streamlet.Invariants.History.html#5014" class="Bound">p≢</a> <a id="5038" class="Symbol">=</a> <a id="5040" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="5046" href="Function.Base.html#3839" class="Function Operator">$′</a> <a id="5049" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="5052" class="Bound">m∈</a>
  <a id="5057" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">QED</a> <a id="5061" class="Symbol">|</a> <a id="5063" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="5065" href="Protocol.Streamlet.Local.Step.html#2361" class="InductiveConstructor">RegisterVote</a> <a id="5078" class="Symbol">{</a><a id="5079" class="Argument">sb</a> <a id="5082" class="Symbol">=</a> <a id="5084" href="Protocol.Streamlet.Invariants.History.html#5084" class="Bound">sb</a><a id="5086" class="Symbol">}</a> <a id="5088" href="Protocol.Streamlet.Invariants.History.html#5088" class="Bound">M∈</a> <a id="5091" href="Protocol.Streamlet.Invariants.History.html#5091" class="Bound">M∉</a>
    <a id="5098" class="Keyword">with</a> <a id="5103" class="Bound">p</a> <a id="5105" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="5107" href="Protocol.Streamlet.Invariants.History.html#4584" class="Bound">p′</a>
  <a id="5112" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">...</a> <a id="5116" class="Symbol">|</a> <a id="5118" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="5122" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5127" class="Keyword">rewrite</a> <a id="5135" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>    <a id="5146" class="Symbol">=</a> <a id="5148" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="5151" class="Symbol">(</a><a id="5152" href="Prelude.Lists.html#3782" class="Function">∈-removeAt⁻</a> <a id="5164" class="Symbol">_</a> <a id="5166" class="Bound">m∈</a><a id="5168" class="Symbol">)</a>
  <a id="5172" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">...</a> <a id="5176" class="Symbol">|</a> <a id="5178" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="5182" href="Protocol.Streamlet.Invariants.History.html#5182" class="Bound">p≢</a>   <a id="5187" class="Keyword">rewrite</a> <a id="5195" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="5203" href="Protocol.Streamlet.Invariants.History.html#5182" class="Bound">p≢</a> <a id="5206" class="Symbol">=</a> <a id="5208" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="5211" class="Bound">m∈</a>
  <a id="5216" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">QED</a> <a id="5220" class="Symbol">|</a> <a id="5222" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="5224" href="Protocol.Streamlet.Local.Step.html#2751" class="InductiveConstructor">FinalizeBlock</a> <a id="5238" href="Protocol.Streamlet.Invariants.History.html#5238" class="Bound">ch</a> <a id="5241" class="Symbol">_</a> <a id="5243" class="Symbol">_</a> <a id="5245" class="Symbol">_</a>
    <a id="5251" class="Keyword">with</a> <a id="5256" class="Bound">p</a> <a id="5258" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="5260" href="Protocol.Streamlet.Invariants.History.html#4584" class="Bound">p′</a>
  <a id="5265" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">...</a> <a id="5269" class="Symbol">|</a> <a id="5271" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="5275" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5280" class="Keyword">rewrite</a> <a id="5288" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a> <a id="5296" class="Symbol">=</a> <a id="5298" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="5301" class="Bound">m∈</a>
  <a id="5306" href="Protocol.Streamlet.Invariants.History.html#4653" class="Function">...</a> <a id="5310" class="Symbol">|</a> <a id="5312" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="5315" href="Protocol.Streamlet.Invariants.History.html#5315" class="Bound">p≢</a> <a id="5318" class="Keyword">rewrite</a> <a id="5326" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="5334" href="Protocol.Streamlet.Invariants.History.html#5315" class="Bound">p≢</a> <a id="5337" class="Symbol">=</a> <a id="5339" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="5342" class="Bound">m∈</a>
<a id="5345" class="Symbol">...</a> <a id="5349" class="Symbol">|</a> <a id="5351" href="Protocol.Streamlet.Global.Step.html#2028" class="InductiveConstructor">DishonestLocalStep</a> <a id="5370" class="Symbol">_</a> <a id="5372" class="Symbol">_</a>
  <a id="5376" class="Symbol">=</a> <a id="5378" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="5384" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5386" href="Protocol.Streamlet.Invariants.History.html#4055" class="Bound">IH</a> <a id="5389" class="Bound">m∈</a>

<a id="5393" class="Comment">-- ** honest participants′ message databases are completely recorded in history</a>
<a id="HistoryComplete"></a><a id="5473" href="Protocol.Streamlet.Invariants.History.html#5473" class="Function">HistoryComplete</a> <a id="5489" class="Symbol">:</a> <a id="5491" href="Protocol.Streamlet.Global.Traces.html#966" class="Function">StateProperty</a>
<a id="5505" href="Protocol.Streamlet.Invariants.History.html#5473" class="Function">HistoryComplete</a> <a id="5521" href="Protocol.Streamlet.Invariants.History.html#5521" class="Bound">s</a> <a id="5523" class="Symbol">=</a> <a id="5525" class="Symbol">∀</a> <a id="5527" class="Symbol">{</a><a id="5528" href="Protocol.Streamlet.Invariants.History.html#5528" class="Bound">p</a><a id="5529" class="Symbol">}</a> <a id="5531" class="Symbol">⦃</a> <a id="5533" href="Protocol.Streamlet.Invariants.History.html#5533" class="Bound">_</a> <a id="5535" class="Symbol">:</a> <a id="5537" href="Protocol.Streamlet.Assumptions.html#1062" class="Field">Honest</a> <a id="5544" href="Protocol.Streamlet.Invariants.History.html#5528" class="Bound">p</a> <a id="5546" class="Symbol">⦄</a> <a id="5548" class="Symbol">→</a>
  <a id="5552" href="Prelude.InferenceRules.html#46076" class="Function Operator">─────────────────────────</a>
  <a id="5580" class="Symbol">(</a><a id="5581" href="Protocol.Streamlet.Invariants.History.html#5521" class="Bound">s</a> <a id="5583" href="Protocol.Streamlet.Global.State.html#1568" class="Function Operator">＠</a> <a id="5585" href="Protocol.Streamlet.Invariants.History.html#5528" class="Bound">p</a><a id="5586" class="Symbol">)</a> <a id="5588" class="Symbol">.</a><a id="5589" href="Protocol.Streamlet.Local.State.html#961" class="Field">db</a> <a id="5592" href="Data.List.Relation.Binary.Subset.Setoid.html#825" class="Function Operator">⊆ˢ</a> <a id="5595" href="Protocol.Streamlet.Invariants.History.html#5521" class="Bound">s</a> <a id="5597" class="Symbol">.</a><a id="5598" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>

<a id="historyComplete"></a><a id="5607" href="Protocol.Streamlet.Invariants.History.html#5607" class="Function">historyComplete</a> <a id="5623" class="Symbol">:</a> <a id="5625" href="Prelude.Closures.html#3717" class="Function">Invariant</a> <a id="5635" href="Protocol.Streamlet.Invariants.History.html#5473" class="Function">HistoryComplete</a>
<a id="5651" href="Protocol.Streamlet.Invariants.History.html#5607" class="Function">historyComplete</a> <a id="5667" class="Symbol">(_</a> <a id="5670" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5672" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5677" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5679" class="Symbol">(_</a> <a id="5682" href="Prelude.Closures.html#689" class="InductiveConstructor Operator">∎</a><a id="5683" class="Symbol">))</a> <a id="5686" class="Symbol">{</a><a id="5687" href="Protocol.Streamlet.Invariants.History.html#5687" class="Bound">p</a><a id="5688" class="Symbol">}</a> <a id="5690" href="Protocol.Streamlet.Invariants.History.html#5690" class="Bound">m∈</a>
  <a id="5695" class="Keyword">rewrite</a> <a id="5703" class="Keyword">let</a> <a id="5707" class="Keyword">open</a> <a id="5712" href="Protocol.Streamlet.Global.Step.html#3796" class="Module">∣Base∣</a> <a id="5719" href="Protocol.Streamlet.Invariants.History.html#5687" class="Bound">p</a> <a id="5721" class="Keyword">in</a> <a id="5724" href="Protocol.Streamlet.Global.Step.html#3830" class="Function">lookup✓</a>
  <a id="5734" class="Symbol">=</a> <a id="5736" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="5741" href="Protocol.Streamlet.Invariants.History.html#5690" class="Bound">m∈</a> <a id="5744" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="5747" class="Symbol">λ</a> <a id="5749" class="Symbol">()</a>
<a id="5752" href="Protocol.Streamlet.Invariants.History.html#5607" class="Function">historyComplete</a> <a id="5768" class="Symbol">{</a><a id="5769" href="Protocol.Streamlet.Invariants.History.html#5769" class="Bound">s′</a><a id="5771" class="Symbol">}</a> <a id="5773" class="Symbol">(_</a> <a id="5776" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5778" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5783" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5785" class="Symbol">(_</a> <a id="5788" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">⟨</a> <a id="5790" href="Protocol.Streamlet.Invariants.History.html#5790" class="Bound">s→</a> <a id="5793" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">∣</a> <a id="5795" href="Protocol.Streamlet.Invariants.History.html#5795" class="Bound">s</a> <a id="5797" href="Prelude.Closures.html#830" class="InductiveConstructor Operator">⟩←—</a> <a id="5801" href="Protocol.Streamlet.Invariants.History.html#5801" class="Bound">tr</a><a id="5803" class="Symbol">))</a>
  <a id="5808" class="Symbol">{</a><a id="5809" href="Protocol.Streamlet.Invariants.History.html#5809" class="Bound">p</a><a id="5810" class="Symbol">}</a> <a id="5812" class="Symbol">⦃</a> <a id="5814" href="Protocol.Streamlet.Invariants.History.html#5814" class="Bound">hp</a> <a id="5817" class="Symbol">⦄</a> <a id="5819" class="Symbol">{</a><a id="5820" href="Protocol.Streamlet.Invariants.History.html#5820" class="Bound">m</a><a id="5821" class="Symbol">}</a> <a id="5823" href="Protocol.Streamlet.Invariants.History.html#5823" class="Bound">m∈</a>
  <a id="5828" class="Keyword">with</a> <a id="5833" href="Protocol.Streamlet.Invariants.History.html#5833" class="Bound">Rs</a> ← <a id="5838" href="Data.Product.Base.html#1932" class="Function Operator">-,</a> <a id="5841" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="5846" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5848" href="Protocol.Streamlet.Invariants.History.html#5801" class="Bound">tr</a>
  <a id="5853" class="Keyword">with</a> <a id="5858" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> ← <a id="5863" href="Protocol.Streamlet.Invariants.History.html#5607" class="Function">historyComplete</a> <a id="5879" href="Protocol.Streamlet.Invariants.History.html#5833" class="Bound">Rs</a> <a id="5882" class="Symbol">⦃</a> <a id="5884" href="Function.Base.html#4736" class="Function">it</a> <a id="5887" class="Symbol">⦄</a>
  <a id="5891" class="Keyword">with</a> <a id="5896" href="Protocol.Streamlet.Invariants.History.html#5790" class="Bound">s→</a>
<a id="5899" class="Symbol">...</a> <a id="5903" class="Symbol">|</a> <a id="5905" href="Protocol.Streamlet.Global.Step.html#2366" class="InductiveConstructor">Deliver</a> <a id="5913" class="Symbol">{</a><a id="5914" class="Argument">env</a> <a id="5918" class="Symbol">=</a> <a id="5920" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">[</a> <a id="5922" href="Protocol.Streamlet.Invariants.History.html#5922" class="Bound">p′</a> <a id="5925" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">∣</a> <a id="5927" href="Protocol.Streamlet.Invariants.History.html#5927" class="Bound">m′</a> <a id="5930" href="Protocol.Streamlet.Message.html#919" class="InductiveConstructor Operator">⟩</a><a id="5931" class="Symbol">}</a> <a id="5933" href="Protocol.Streamlet.Invariants.History.html#5933" class="Bound">env∈</a>
  <a id="5940" class="Symbol">=</a> <a id="5942" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="5945" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5947" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a> <a id="5953" class="Symbol">(_</a> <a id="5956" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈_</a><a id="5958" class="Symbol">)</a> <a id="5960" href="Protocol.Streamlet.Global.Step.html#4348" class="Function">db≡</a> <a id="5964" class="Bound">m∈</a>
  <a id="5969" class="Keyword">where</a>
  <a id="5977" class="Keyword">open</a> <a id="5982" href="Protocol.Streamlet.Global.Step.html#3985" class="Module">∣Deliver∣</a> <a id="5992" class="Bound">p</a> <a id="5994" class="Bound">s</a> <a id="5996" href="Protocol.Streamlet.Invariants.History.html#5933" class="Bound">env∈</a>

<a id="6002" class="Symbol">...</a> <a id="6006" class="Symbol">|</a> <a id="6008" href="Protocol.Streamlet.Global.Step.html#2518" class="InductiveConstructor">AdvanceEpoch</a>
  <a id="6023" class="Keyword">rewrite</a> <a id="6031" class="Keyword">let</a> <a id="6035" class="Keyword">open</a> <a id="6040" href="Protocol.Streamlet.Global.Step.html#3883" class="Module">∣AdvanceEpoch∣</a> <a id="6055" class="Bound">p</a> <a id="6057" class="Bound">s</a> <a id="6059" class="Keyword">in</a> <a id="6062" href="Protocol.Streamlet.Global.Step.html#3927" class="Function">lookup✓</a>
  <a id="6072" class="Symbol">=</a> <a id="6074" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="6077" class="Bound">m∈</a>
<a id="6080" class="Symbol">...</a> <a id="6084" class="Symbol">|</a> <a id="6086" href="Protocol.Streamlet.Global.Step.html#2625" class="InductiveConstructor">Drop</a> <a id="6091" class="Symbol">_</a>
  <a id="6095" class="Symbol">=</a> <a id="6097" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="6100" class="Bound">m∈</a>
<a id="6103" class="Symbol">...</a> <a id="6107" class="Symbol">|</a> <a id="6109" href="Protocol.Streamlet.Global.Step.html#1649" class="InductiveConstructor">LocalStep</a> <a id="6119" class="Symbol">{</a><a id="6120" class="Argument">p</a> <a id="6122" class="Symbol">=</a> <a id="6124" href="Protocol.Streamlet.Invariants.History.html#6124" class="Bound">p′</a><a id="6126" class="Symbol">}{</a><a id="6128" href="Protocol.Streamlet.Invariants.History.html#6128" class="Bound">mm</a><a id="6130" class="Symbol">}{</a><a id="6132" href="Protocol.Streamlet.Invariants.History.html#6132" class="Bound">ls′</a><a id="6135" class="Symbol">}</a> <a id="6137" href="Protocol.Streamlet.Invariants.History.html#6137" class="Bound">ls→</a>
  <a id="6143" class="Symbol">=</a> <a id="6145" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">QED</a>
  <a id="6151" class="Keyword">where</a>
  <a id="6159" class="Keyword">open</a> <a id="6164" href="Protocol.Streamlet.Global.Step.html#4791" class="Module">∣LocalStep∣</a> <a id="6176" class="Bound">p</a> <a id="6178" href="Protocol.Streamlet.Invariants.History.html#6124" class="Bound">p′</a> <a id="6181" class="Bound">s</a> <a id="6183" href="Protocol.Streamlet.Invariants.History.html#6128" class="Bound">mm</a> <a id="6186" href="Protocol.Streamlet.Invariants.History.html#6132" class="Bound">ls′</a>

  <a id="6193" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">QED</a> <a id="6197" class="Symbol">:</a> <a id="6199" class="Bound">m</a> <a id="6201" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="6203" class="Bound">s′</a> <a id="6206" class="Symbol">.</a><a id="6207" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>
  <a id="6217" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">QED</a> <a id="6221" class="Keyword">with</a> <a id="6226" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6228" href="Protocol.Streamlet.Invariants.History.html#6137" class="Bound">ls→</a>
  <a id="6234" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">QED</a> <a id="6238" class="Symbol">|</a> <a id="6240" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6242" href="Protocol.Streamlet.Local.Step.html#1314" class="InductiveConstructor">ProposeBlock</a> <a id="6255" class="Symbol">{</a><a id="6256" class="Argument">ch</a> <a id="6259" class="Symbol">=</a> <a id="6261" href="Protocol.Streamlet.Invariants.History.html#6261" class="Bound">ch</a><a id="6263" class="Symbol">}</a> <a id="6265" class="Symbol">{</a><a id="6266" class="Argument">txs</a> <a id="6270" class="Symbol">=</a> <a id="6272" href="Protocol.Streamlet.Invariants.History.html#6272" class="Bound">txs</a><a id="6275" class="Symbol">}</a> <a id="6277" class="Symbol">_</a> <a id="6279" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6284" class="Symbol">_</a> <a id="6286" class="Symbol">_</a>
    <a id="6292" class="Keyword">with</a> <a id="6297" class="Bound">p</a> <a id="6299" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="6301" href="Protocol.Streamlet.Invariants.History.html#6124" class="Bound">p′</a>
  <a id="6306" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">...</a> <a id="6310" class="Symbol">|</a> <a id="6312" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="6316" href="Protocol.Streamlet.Invariants.History.html#6316" class="Bound">p≢</a>   <a id="6321" class="Keyword">rewrite</a> <a id="6329" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="6337" href="Protocol.Streamlet.Invariants.History.html#6316" class="Bound">p≢</a> <a id="6340" class="Symbol">=</a> <a id="6342" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6348" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6350" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="6353" class="Bound">m∈</a>
  <a id="6358" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">...</a> <a id="6362" class="Symbol">|</a> <a id="6364" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="6368" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6373" class="Keyword">rewrite</a> <a id="6381" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>
    <a id="6393" class="Keyword">with</a> <a id="6398" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6400" class="Bound">m∈</a>
  <a id="6405" class="Symbol">...</a> <a id="6409" class="Symbol">|</a> <a id="6411" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6413" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="6418" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6423" class="Symbol">=</a> <a id="6425" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="6430" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="6437" class="Symbol">...</a> <a id="6441" class="Symbol">|</a> <a id="6443" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6445" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6451" href="Protocol.Streamlet.Invariants.History.html#6451" class="Bound">m∈</a> <a id="6454" class="Symbol">=</a> <a id="6456" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6462" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6464" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="6467" href="Protocol.Streamlet.Invariants.History.html#6451" class="Bound">m∈</a>
  <a id="6472" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">QED</a> <a id="6476" class="Symbol">|</a> <a id="6478" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6480" href="Protocol.Streamlet.Local.Step.html#1710" class="InductiveConstructor">VoteBlock</a> <a id="6490" class="Symbol">{</a><a id="6491" class="Argument">txs</a> <a id="6495" class="Symbol">=</a> <a id="6497" href="Protocol.Streamlet.Invariants.History.html#6497" class="Bound">txs</a><a id="6500" class="Symbol">}</a> <a id="6502" href="Protocol.Streamlet.Invariants.History.html#6502" class="Bound">M∈</a> <a id="6505" class="Symbol">_</a> <a id="6507" class="Symbol">_</a> <a id="6509" class="Symbol">_</a> <a id="6511" class="Symbol">_</a> <a id="6513" class="Symbol">_</a>
    <a id="6519" class="Keyword">with</a> <a id="6524" class="Bound">p</a> <a id="6526" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="6528" href="Protocol.Streamlet.Invariants.History.html#6124" class="Bound">p′</a>
  <a id="6533" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">...</a> <a id="6537" class="Symbol">|</a> <a id="6539" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="6543" href="Protocol.Streamlet.Invariants.History.html#6543" class="Bound">p≢</a>   <a id="6548" class="Keyword">rewrite</a> <a id="6556" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="6564" href="Protocol.Streamlet.Invariants.History.html#6543" class="Bound">p≢</a> <a id="6567" class="Symbol">=</a> <a id="6569" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6575" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6577" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="6580" class="Bound">m∈</a>
  <a id="6585" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">...</a> <a id="6589" class="Symbol">|</a> <a id="6591" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="6595" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6600" class="Keyword">rewrite</a> <a id="6608" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>
    <a id="6620" class="Keyword">with</a> <a id="6625" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6627" class="Bound">m∈</a>
  <a id="6632" class="Symbol">...</a> <a id="6636" class="Symbol">|</a> <a id="6638" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6640" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="6645" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6650" class="Symbol">=</a> <a id="6652" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="6657" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="6664" class="Symbol">...</a> <a id="6668" class="Symbol">|</a> <a id="6670" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6672" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6678" class="Symbol">(</a><a id="6679" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="6684" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="6688" class="Symbol">)</a> <a id="6690" class="Symbol">=</a> <a id="6692" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6698" href="Protocol.Streamlet.Invariants.History.html#6715" class="Function">P∈</a>
    <a id="6705" class="Keyword">where</a>
    <a id="6715" href="Protocol.Streamlet.Invariants.History.html#6715" class="Function">P∈</a> <a id="6718" class="Symbol">:</a> <a id="6720" class="Symbol">_</a> <a id="6722" href="Data.List.Membership.Setoid.html#950" class="Function Operator">∈</a> <a id="6724" class="Bound">s</a> <a id="6726" class="Symbol">.</a><a id="6727" href="Protocol.Streamlet.Global.State.html#939" class="Field">history</a>
    <a id="6739" href="Protocol.Streamlet.Invariants.History.html#6715" class="Function">P∈</a> <a id="6742" class="Symbol">=</a> <a id="6744" href="Protocol.Streamlet.Invariants.History.html#3795" class="Function">inboxCompleteHonest</a> <a id="6764" href="Protocol.Streamlet.Invariants.History.html#5833" class="Bound">Rs</a> <a id="6767" class="Symbol">⦃</a> <a id="6769" class="Bound">hp</a> <a id="6772" class="Symbol">⦄</a> <a id="6774" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6776" href="Prelude.Irrelevance.html#1735" class="Function">AnyFirst⇒Any</a> <a id="6789" class="Bound">M∈</a>
  <a id="6794" class="Symbol">...</a> <a id="6798" class="Symbol">|</a> <a id="6800" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6802" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6808" class="Symbol">(</a><a id="6809" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6815" href="Protocol.Streamlet.Invariants.History.html#6815" class="Bound">m∈</a><a id="6817" class="Symbol">)</a> <a id="6819" class="Symbol">=</a> <a id="6821" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="6827" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6829" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="6832" href="Protocol.Streamlet.Invariants.History.html#6815" class="Bound">m∈</a>
  <a id="6837" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">QED</a> <a id="6841" class="Symbol">|</a> <a id="6843" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6845" href="Protocol.Streamlet.Local.Step.html#2361" class="InductiveConstructor">RegisterVote</a> <a id="6858" class="Symbol">{</a><a id="6859" class="Argument">sb</a> <a id="6862" class="Symbol">=</a> <a id="6864" href="Protocol.Streamlet.Invariants.History.html#6864" class="Bound">sb</a><a id="6866" class="Symbol">}</a> <a id="6868" href="Protocol.Streamlet.Invariants.History.html#6868" class="Bound">M∈</a> <a id="6871" href="Protocol.Streamlet.Invariants.History.html#6871" class="Bound">M∉</a>
    <a id="6878" class="Keyword">with</a> <a id="6883" class="Bound">p</a> <a id="6885" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="6887" href="Protocol.Streamlet.Invariants.History.html#6124" class="Bound">p′</a>
  <a id="6892" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">...</a> <a id="6896" class="Symbol">|</a> <a id="6898" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a>  <a id="6902" href="Protocol.Streamlet.Invariants.History.html#6902" class="Bound">p≢</a>   <a id="6907" class="Keyword">rewrite</a> <a id="6915" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="6923" href="Protocol.Streamlet.Invariants.History.html#6902" class="Bound">p≢</a> <a id="6926" class="Symbol">=</a> <a id="6928" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="6931" class="Bound">m∈</a>
  <a id="6936" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">...</a> <a id="6940" class="Symbol">|</a> <a id="6942" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="6946" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6951" class="Keyword">rewrite</a> <a id="6959" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a>
    <a id="6971" class="Keyword">with</a> <a id="6976" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6978" class="Bound">m∈</a>
  <a id="6983" class="Symbol">...</a> <a id="6987" class="Symbol">|</a> <a id="6989" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="6991" href="Data.List.Relation.Unary.Any.html#1226" class="InductiveConstructor">here</a> <a id="6996" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="7001" class="Symbol">=</a> <a id="7003" href="Protocol.Streamlet.Invariants.History.html#3795" class="Function">inboxCompleteHonest</a> <a id="7023" href="Protocol.Streamlet.Invariants.History.html#5833" class="Bound">Rs</a> <a id="7026" class="Symbol">⦃</a> <a id="7028" class="Bound">hp</a> <a id="7031" class="Symbol">⦄</a> <a id="7033" class="Bound">M∈</a>
  <a id="7038" class="Symbol">...</a> <a id="7042" class="Symbol">|</a> <a id="7044" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="7046" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="7052" href="Protocol.Streamlet.Invariants.History.html#7052" class="Bound">m∈</a>  <a id="7056" class="Symbol">=</a> <a id="7058" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="7061" href="Protocol.Streamlet.Invariants.History.html#7052" class="Bound">m∈</a>
  <a id="7066" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">QED</a> <a id="7070" class="Symbol">|</a> <a id="7072" href="Prelude.Init.html#7442" class="InductiveConstructor Operator">⟫</a> <a id="7074" href="Protocol.Streamlet.Local.Step.html#2751" class="InductiveConstructor">FinalizeBlock</a> <a id="7088" href="Protocol.Streamlet.Invariants.History.html#7088" class="Bound">ch</a> <a id="7091" class="Symbol">_</a> <a id="7093" class="Symbol">_</a> <a id="7095" class="Symbol">_</a>
    <a id="7101" class="Keyword">with</a> <a id="7106" class="Bound">p</a> <a id="7108" href="Prelude.DecEq.html#123" class="Field Operator">≟</a> <a id="7110" href="Protocol.Streamlet.Invariants.History.html#6124" class="Bound">p′</a>
  <a id="7115" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">...</a> <a id="7119" class="Symbol">|</a> <a id="7121" href="Relation.Nullary.Decidable.Core.html#1618" class="InductiveConstructor">yes</a> <a id="7125" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="7130" class="Keyword">rewrite</a> <a id="7138" href="Protocol.Streamlet.Global.Step.html#4963" class="Function">lookup✓</a> <a id="7146" class="Symbol">=</a> <a id="7148" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="7151" class="Bound">m∈</a>
  <a id="7156" href="Protocol.Streamlet.Invariants.History.html#6193" class="Function">...</a> <a id="7160" class="Symbol">|</a> <a id="7162" href="Relation.Nullary.Decidable.Core.html#1655" class="InductiveConstructor">no</a> <a id="7165" href="Protocol.Streamlet.Invariants.History.html#7165" class="Bound">p≢</a> <a id="7168" class="Keyword">rewrite</a> <a id="7176" href="Protocol.Streamlet.Global.Step.html#5027" class="Function">lookup✖</a> <a id="7184" href="Protocol.Streamlet.Invariants.History.html#7165" class="Bound">p≢</a> <a id="7187" class="Symbol">=</a> <a id="7189" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="7192" class="Bound">m∈</a>
<a id="7195" class="Symbol">...</a> <a id="7199" class="Symbol">|</a> <a id="7201" href="Protocol.Streamlet.Global.Step.html#2028" class="InductiveConstructor">DishonestLocalStep</a> <a id="7220" class="Symbol">_</a> <a id="7222" class="Symbol">_</a>
  <a id="7226" class="Symbol">=</a> <a id="7228" href="Data.List.Relation.Unary.Any.html#1279" class="InductiveConstructor">there</a> <a id="7234" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7236" href="Protocol.Streamlet.Invariants.History.html#5858" class="Bound">IH</a> <a id="7239" class="Bound">m∈</a>
</pre>
</body>
</html>
